C:\ZH099\pkg\systems\brainAI\commands\gm\npcstatus.src, Line 16
program textcmd_NPCStatus(who)
CONST REPORT_ALL	:= 0x7;
0: get arg 'who'
if( !AuthorizationCode( who ))
1: local #0
2: makelocal
3: jmp userfunc @180
4: if true goto 13
SendSysMessage( who, "Cancelled." );
5: local #0
6: "Cancelled."
7: 3L
8: 1000L
9: Func(2,5): SendSysMessage
10: #
return 0;
11: 0L
12: progend
var targ := Target( who, TGTOPT_NOCHECK_LOS );
13: decl local #1
14: local #0
15: 0L
16: Func(2,11): Target
17: :=
18: #
if( !targ.IsA( POLCLASS_NPC ))
19: local #1
20: 4L
21: Call Method id isa (#0, 1 params)
22: if true goto 31
SendSysMessage( who, "Cancelled." );
23: local #0
24: "Cancelled."
25: 3L
26: 1000L
27: Func(2,5): SendSysMessage
28: #
return 0;
29: 0L
30: progend
var gump := GFCreateGump();
31: decl local #2
32: 0L
33: 0L
34: 0L
35: 0L
36: makelocal
37: jmp userfunc @253
38: :=
39: #
GFResizePic( gump, 0, 0, GFGetCfgConst( "Defaults", "BackGround" ), 400, 480 );
40: local #2
41: 0L
42: 0L
43: "Defaults"
44: "BackGround"
45: makelocal
46: jmp userfunc @334
47: 400L
48: 480L
49: makelocal
50: jmp userfunc @466
51: #
GFResizePic( gump, 15, 15, GFGetCfgConst( "Defaults", "ForeGround" ), 370, 450 
52: local #2
53: 15L
54: 15L
55: "Defaults"
56: "ForeGround"
57: makelocal
58: jmp userfunc @334
59: 370L
60: 450L
61: makelocal
62: jmp userfunc @466
63: #
GFTextMid( gump, 0, 15, 300, 2100, "Brain NPC Info" );
64: local #2
65: 0L
66: 15L
67: 300L
68: 2100L
69: "Brain NPC Info"
70: makelocal
71: jmp userfunc @561
72: #
var text := "<B>NERVES</B><BR>";			
73: decl local #3
74: "<B>NERVES</B><BR>"
75: :=
76: #
foreach nerve in ( LoadNerves( targ ))
77: local #1
78: makelocal
79: jmp userfunc @586
80: initforeach @124
var state := GetProcess( nerve.pid ).state;
81: decl local #0
82: local #4
83: get member id 'pid' (103)
84: Func(3,1): GetProcess
85: get member id 'state' (104)
86: :=
87: #
if( !state )
88: local #7
89: if true goto 92
state := "PID Killed";
90: "PID Killed"
91: local7 := 
text += "<U>"+_nerve_iter+"</U><BR>"+
92: local #3
93: "<U>"
94: local #6
95: +
96: "</U><BR>"
97: +
98: "Pid: "
99: +
100: local #4
101: get member id 'pid' (103)
102: +
103: "<BR>"
104: +
105: "Flags: "
106: +
107: local #4
108: get member 'flags'
109: +
110: "<BR>"
111: +
112: "Status: "
113: +
114: local #7
115: +
116: "<BR><BR>"
117: +
118: +=
119: #
SleepMS(2);
120: 2L
121: Func(3,2): Sleepms
122: #
123: leave block(1)
124: stepforeach @81
125: leave block(3)
text := text+"<BR><B>WATCH LIST</B><BR>";
126: local #3
127: "<BR><B>WATCH LIST</B><BR>"
128: +
129: local3 := 
foreach serial in ( NPC_LoadWatchList( targ ).Keys() )
130: local #1
131: makelocal
132: jmp userfunc @688
133: Call Method id keys (#56, 0 params)
134: initforeach @158
var name := SystemFindObjectBySerial( CInt( serial )).name;
135: decl local #0
136: local #4
137: Func(0,2): CInt
138: 0L
139: Func(2,12): SystemFindObjectBySerial
140: get member id 'name' (3)
141: :=
142: #
text += Hex( serial )+" "+name+"<BR>";
143: local #3
144: local #4
145: Func(0,9): Hex
146: " "
147: +
148: local #7
149: +
150: "<BR>"
151: +
152: +=
153: #
SleepMS(2);
154: 2L
155: Func(3,2): Sleepms
156: #
157: leave block(1)
158: stepforeach @135
159: leave block(3)
GFHTMLArea( gump, 25, 40, 357, 423, text, 0, 1 );
160: local #2
161: 25L
162: 40L
163: 357L
164: 423L
165: local #3
166: 0L
167: 1L
168: makelocal
169: jmp userfunc @396
170: #
GFSendGump( who, gump );
171: local #0
172: local #2
173: makelocal
174: jmp userfunc @523
175: #
return 1;
176: 1L
177: progend
178: leave block(4)
179: progend
c:/ZH099/scripts/include/security.inc, Line 14
function AuthorizationCode( mobile )
180: pop param 'mobile'
if( GetObjProperty( mobile, "#AuthCodeGiven" ));
181: local #0
182: "#AuthCodeGiven"
183: Func(2,2): GetObjProperty
184: if false goto 187
return 1;
185: 1L
186: return
var autocode := GetGlobalProperty( "CA" );
187: decl local #1
188: "CA"
189: Func(2,8): GetGlobalProperty
190: :=
191: #
if( !autocode )
192: local #1
193: if true goto 209
SendSysMessage( mobile, "Authorization code is not given yet.", 3, 53 );
194: local #0
195: "Authorization code is not given yet."
196: 3L
197: 53L
198: Func(2,5): SendSysMessage
199: #
SendSysMessage( mobile, "Uses .setauthcode to create a new code.", 3, 53 );
200: local #0
201: "Uses .setauthcode to create a new code."
202: 3L
203: 53L
204: Func(2,5): SendSysMessage
205: #
return 0;
206: 0L
207: return
208: goto251
var code := SendTextEntryGump( mobile, "Enter the Authorization Code.", TE_CANC
209: decl local #0
210: local #0
211: "Enter the Authorization Code."
212: 1L
213: 1L
214: 10L
215: ""
216: Func(2,9): SendTextEntryGump
217: :=
218: #
if( code == autocode )
219: local #2
220: local #1
221: ==
222: if false goto 237
SendSysMessage( mobile, "Code Accepted!", 3, 70 );
223: local #0
224: "Code Accepted!"
225: 3L
226: 70L
227: Func(2,5): SendSysMessage
228: #
SetObjProperty( mobile, "#AuthCodeGiven", 1 );
229: local #0
230: "#AuthCodeGiven"
231: 1L
232: Func(2,1): SetObjProperty
233: #
return 1;
234: 1L
235: return
236: goto250
SendSysMessage( mobile, "It is not the Authorization code.", 3, 33 );
237: local #0
238: "It is not the Authorization code."
239: 3L
240: 33L
241: Func(2,5): SendSysMessage
242: #
NotifyStaffOnline( mobile, "has provided a wrong authorization code." );
243: local #0
244: "has provided a wrong authorization code."
245: makelocal
246: jmp userfunc @603
247: #
return 0;
248: 0L
249: return
250: leave block(1)
251: 0L
252: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 40
function GFCreateGump(x:=0, y:=0, width:=0, height:=0)
253: pop param 'height'
254: pop param 'width'
255: pop param 'y'
256: pop param 'x'
var gump := struct;
257: decl local #4
258: struct
259: :=
260: #
gump.+base := struct;
261: local #4
262: "base"
263: .+
264: struct
265: := #
gump.base.+x := CInt(x);
266: local #4
267: get member 'base'
268: "x"
269: .+
270: local #3
271: Func(0,2): CInt
272: := #
gump.base.+y := CInt(y);
273: local #4
274: get member 'base'
275: "y"
276: .+
277: local #2
278: Func(0,2): CInt
279: := #
gump.base.+width := CInt(width);
280: local #4
281: get member 'base'
282: "width"
283: .+
284: local #1
285: Func(0,2): CInt
286: := #
gump.base.+height := CInt(height);
287: local #4
288: get member 'base'
289: "height"
290: .+
291: local #0
292: Func(0,2): CInt
293: := #
gump.base.+MoveLoc := 0;	// Movable flag location
294: local #4
295: get member 'base'
296: "MoveLoc"
297: .+
298: 0L
299: := #
gump.base.+CloseLoc := 0;	// NoClose flag location
300: local #4
301: get member 'base'
302: "CloseLoc"
303: .+
304: 0L
305: := #
gump.base.+DisposeLoc := 0;	// NoDispose flag location
306: local #4
307: get member 'base'
308: "DisposeLoc"
309: .+
310: 0L
311: := #
gump.+layout	:= array;	// Main layout array for entire gump
312: local #4
313: "layout"
314: .+
315: array
316: := #
gump.+data	:= array;	// Storage array for static-text and
317: local #4
318: "data"
319: .+
320: array
321: := #
gump.+data_id	:= 1;
322: local #4
323: "data_id"
324: .+
325: 1L
326: := #
gump.+cur_page := 0;
327: local #4
328: "cur_page"
329: .+
330: 0L
331: := #
return(gump);
332: local #4
333: return
c:/ZH099/pkg/utils/gumps/include/gumps_ex.inc, Line 37
function GFGetCfgConst(elem_name, prop_name)
334: pop param 'prop_name'
335: pop param 'elem_name'
var cfg := ReadConfigFile(":gumps:GumpInfo");
336: decl local #2
337: ":gumps:GumpInfo"
338: Func(5,0): ReadConfigFile
339: :=
340: #
if ( cfg.errortext )
341: local #2
342: get member 'errortext'
343: if false goto 352
return XGFError("GFGetCfgConst():: Unable to open GumpInfo.cfg -> "+cfg.errorte
344: "GFGetCfgConst():: Unable to open GumpInfo.cfg -> "
345: local #2
346: get member 'errortext'
347: +
348: 0L
349: makelocal
350: jmp userfunc @770
351: return
var elem := cfg[elem_name];
352: decl local #3
353: local #2
354: local #1
355: [] 1
356: :=
357: #
if ( elem.errortext )
358: local #3
359: get member 'errortext'
360: if false goto 373
return XGFError("GFGetCfgConst():: Unable to find GumpInfo.cfg["+elem_name+"] -
361: "GFGetCfgConst():: Unable to find GumpInfo.cfg["
362: local #1
363: +
364: "] ->"
365: +
366: local #3
367: get member 'errortext'
368: +
369: 0L
370: makelocal
371: jmp userfunc @770
372: return
var value := GetConfigInt(elem, prop_name);
373: decl local #4
374: local #3
375: local #0
376: Func(5,1): GetConfigInt
377: :=
378: #
if ( !value )
379: local #4
380: if true goto 394
return XGFError("GFGetCfgConst():: Unable to find property ["+prop_name+"] in e
381: "GFGetCfgConst():: Unable to find property ["
382: local #0
383: +
384: "] in elem ["
385: +
386: local #1
387: +
388: "]"
389: +
390: 0L
391: makelocal
392: jmp userfunc @770
393: return
return value;
394: local #4
395: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 214
function GFHTMLArea(byref gump, x, y, width, height, text, background:=0, scrol
396: pop param 'scrollbar'
397: pop param 'background'
398: pop param 'text'
399: pop param 'height'
400: pop param 'width'
401: pop param 'y'
402: pop param 'x'
403: pop param byref 'gump'
gump.data.Append(""+CStr(text));
404: local #7
405: get member 'data'
406: ""
407: local #2
408: Func(0,3): CStr
409: +
410: Call Method id append (#52, 1 params)
411: #
var index := gump.data.Size()-1;
412: decl local #8
413: local #7
414: get member 'data'
415: Call Method id size (#48, 0 params)
416: 1L
417: -
418: :=
419: #
(gump.layout).Append("HTMLGump "+CStr(CInt(x))+" "+CStr(CInt(y))+" "
420: local #7
421: get member 'layout'
422: "HTMLGump "
423: local #6
424: Func(0,2): CInt
425: Func(0,3): CStr
426: +
427: " "
428: +
429: local #5
430: Func(0,2): CInt
431: Func(0,3): CStr
432: +
433: " "
434: +
435: local #4
436: Func(0,2): CInt
437: Func(0,3): CStr
438: +
439: " "
440: +
441: local #3
442: Func(0,2): CInt
443: Func(0,3): CStr
444: +
445: " "
446: +
447: local #8
448: Func(0,3): CStr
449: +
450: " "
451: +
452: local #1
453: Func(0,2): CInt
454: Func(0,3): CStr
455: +
456: " "
457: +
458: local #0
459: Func(0,2): CInt
460: Func(0,3): CStr
461: +
462: Call Method id append (#52, 1 params)
463: #
return (index);
464: local #8
465: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 151
function GFResizePic(byref gump, x, y, gump_id, width, height)
466: pop param 'height'
467: pop param 'width'
468: pop param 'gump_id'
469: pop param 'y'
470: pop param 'x'
471: pop param byref 'gump'
width := CInt(width);
472: local #1
473: Func(0,2): CInt
474: local1 := 
height := CInt(height);
475: local #0
476: Func(0,2): CInt
477: local0 := 
if ( !width )
478: local #1
479: if true goto 484
width := gump.base.width;
480: local #5
481: get member 'base'
482: get member 'width'
483: local1 := 
if ( !height )
484: local #0
485: if true goto 490
height := gump.base.width;
486: local #5
487: get member 'base'
488: get member 'width'
489: local0 := 
(gump.layout).Append("ResizePic "+CStr(CInt(x))+" "+CStr(CInt(y))+" "
490: local #5
491: get member 'layout'
492: "ResizePic "
493: local #4
494: Func(0,2): CInt
495: Func(0,3): CStr
496: +
497: " "
498: +
499: local #3
500: Func(0,2): CInt
501: Func(0,3): CStr
502: +
503: " "
504: +
505: local #2
506: Func(0,2): CInt
507: Func(0,3): CStr
508: +
509: " "
510: +
511: local #1
512: Func(0,3): CStr
513: +
514: " "
515: +
516: local #0
517: Func(0,3): CStr
518: +
519: Call Method id append (#52, 1 params)
520: #
return 1;
521: 1L
522: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 314
function GFSendGump(mobile, byref gump)
523: pop param byref 'gump'
524: pop param 'mobile'
var ret_val := SendDialogGump(mobile, gump.layout, gump.data, gump.base.x, gump
525: decl local #2
526: local #1
527: local #0
528: get member 'layout'
529: local #0
530: get member 'data'
531: local #0
532: get member 'base'
533: get member id 'x' (0)
534: local #0
535: get member 'base'
536: get member id 'y' (1)
537: 0L
538: Func(2,4): SendDialogGump
539: :=
540: #
if ( ret_val.errortext )
541: local #2
542: get member 'errortext'
543: if false goto 559
SendSysMessage(mobile, "Error - Unable to display gump.");
544: local #1
545: "Error - Unable to display gump."
546: 3L
547: 1000L
548: Func(2,5): SendSysMessage
549: #
SendSysMessage(mobile, "Error text is ->"+ret_val.errortext);
550: local #1
551: "Error text is ->"
552: local #2
553: get member 'errortext'
554: +
555: 3L
556: 1000L
557: Func(2,5): SendSysMessage
558: #
return ret_val;
559: local #2
560: return
c:/ZH099/pkg/utils/gumps/include/gumps_ex.inc, Line 114
function GFTextMid(byref gump, x, y, width, color, text)
561: pop param 'text'
562: pop param 'color'
563: pop param 'width'
564: pop param 'y'
565: pop param 'x'
566: pop param byref 'gump'
var x_pos := GFTextCoords(ALIGN_CENTER, text, x, CStr(width));
567: decl local #6
568: 1L
569: local #0
570: local #4
571: local #2
572: Func(0,3): CStr
573: makelocal
574: jmp userfunc @830
575: :=
576: #
return GFTextLine(gump, x_pos, y, color, CStr(text));
577: local #5
578: local #6
579: local #3
580: local #1
581: local #0
582: Func(0,3): CStr
583: makelocal
584: jmp userfunc @870
585: return
c:/ZH099/pkg/systems/brainAI/include/npcNerves.inc, Line 34
function LoadNerves( mobile )
586: pop param 'mobile'
var nerve_dict := GetObjProperty( mobile, "#NerveInfo" );
587: decl local #1
588: local #0
589: "#NerveInfo"
590: Func(2,2): GetObjProperty
591: :=
592: #
if ( Lower( TypeOf( nerve_dict )) != "dictionary" )
593: local #1
594: Func(0,1): TypeOf
595: Func(0,0): Lower
596: "dictionary"
597: <>
598: if false goto 601
nerve_dict := dictionary;
599: dictionary
600: local1 := 
return nerve_dict;
601: local #1
602: return
c:/ZH099/scripts/include/security.inc, Line 40
function NotifyStaffOnline( object, text )
603: pop param 'text'
604: pop param 'object'
var name := object.name;
605: decl local #2
606: local #1
607: get member id 'name' (3)
608: :=
609: #
if( !name )
610: local #2
611: if true goto 619
name := object.desc;
612: local #1
613: get member id 'desc' (19)
614: local2 := 
if( !name )
615: local #2
616: if true goto 619
name := object;
617: local #1
618: local2 := 
foreach character in EnumerateOnlineCharacters()
619: Func(2,10): EnumerateOnlineCharacters
620: initforeach @655
if( GetObjProperty( character, "Notify" ))
621: local #3
622: "Notify"
623: Func(2,2): GetObjProperty
624: if false goto 652
if( object.cmdlevel <= character.cmdlevel || character.cmdlevel >= 4 )
625: local #1
626: get member id 'cmdlevel' (46)
627: local #3
628: get member id 'cmdlevel' (46)
629: <=
630: local #3
631: get member id 'cmdlevel' (46)
632: 4L
633: >=
634: ||
635: if false goto 652
SendSysMessage( character, "You receive a notification:", 3, 55 );
636: local #3
637: "You receive a notification:"
638: 3L
639: 55L
640: Func(2,5): SendSysMessage
641: #
SendSysMessage( character, name+" >>> "+text, 3, 55 );
642: local #3
643: local #2
644: " >>> "
645: +
646: local #0
647: +
648: 3L
649: 55L
650: Func(2,5): SendSysMessage
651: #
SleepMS(5);
652: 5L
653: Func(3,2): Sleepms
654: #
655: stepforeach @621
656: leave block(3)
if( object.serial )
657: local #1
658: get member id 'serial' (6)
659: if false goto 676
ReportText( name+"["+object.serial+"] >>> "+text, REPORT_SYSLOG );
660: local #2
661: "["
662: +
663: local #1
664: get member id 'serial' (6)
665: +
666: "] >>> "
667: +
668: local #0
669: +
670: 2L
671: 0L
672: makelocal
673: jmp userfunc @705
674: #
675: goto686
ReportText( name+" >>> "+text, REPORT_SYSLOG );
676: local #2
677: " >>> "
678: +
679: local #0
680: +
681: 2L
682: 0L
683: makelocal
684: jmp userfunc @705
685: #
return 1;
686: 1L
687: return
c:/ZH099/pkg/systems/brainAI/include/npcWatchList.inc, Line 23
function NPC_LoadWatchList( npc )
688: pop param 'npc'
var watch_dict := GetObjProperty( npc, "#WatchList" );
689: decl local #1
690: local #0
691: "#WatchList"
692: Func(2,2): GetObjProperty
693: :=
694: #
if( Lower( TypeOf( watch_dict )) != "dictionary" )
695: local #1
696: Func(0,1): TypeOf
697: Func(0,0): Lower
698: "dictionary"
699: <>
700: if false goto 703
watch_dict := dictionary;
701: dictionary
702: local1 := 
return watch_dict;
703: local #1
704: return
c:/ZH099/pkg/utils/security/include/report.inc, Line 22
function ReportText( report_text:="?", flags:=REPORT_DISABLE, text_color:=0 )
705: pop param 'text_color'
706: pop param 'flags'
707: pop param 'report_text'
if( !flags )
708: local #1
709: if true goto 713
return 0;
710: 0L
711: return
712: goto768
elseif( flags & REPORT_CONSOLE )
713: local #1
714: 1L
715: &
716: if false goto 723
Print( ""+report_text );
717: ""
718: local #2
719: +
720: Func(1,0): Print
721: #
722: goto768
elseif( flags & REPORT_SYSLOG )
723: local #1
724: 2L
725: &
726: if false goto 757
var script_name := CStr( GetProcess( GetPid() ).name ),
727: decl local #0
728: Func(3,5): GetPid
729: Func(3,1): GetProcess
730: get member id 'name' (3)
731: Func(0,3): CStr
732: :=
733: #
734: decl local #1
735: local #3
736: makelocal
737: jmp userfunc @783
738: :=
739: #
LogToFile( "::log/"+pkg_name+".log", "["+script_name+"]: "+report_text, LOG_DAT
740: "::log/"
741: local #4
742: +
743: ".log"
744: +
745: "["
746: local #3
747: +
748: "]: "
749: +
750: local #2
751: +
752: 1L
753: Func(6,0): LogToFile
754: #
755: leave block(2)
756: goto768
elseif( flags & REPORT_BROADCAST )
757: local #1
758: 4L
759: &
760: if false goto 768
Broadcast( ""+report_text, 3, text_color );
761: ""
762: local #2
763: +
764: 3L
765: local #0
766: Func(2,7): Broadcast
767: #
return 1;
768: 1L
769: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 335
function XGFError(text, log:=0)
770: pop param 'log'
771: pop param 'text'
if ( log )
772: local #0
773: if false goto 779
SysLog("Gump Error:: "+text);
774: "Gump Error:: "
775: local #1
776: +
777: Func(3,0): SysLog
778: #
return error{"errortext":=text};
779: error
780: local #1
781: addmember-assign(errortext)
782: return
c:/ZH099/pkg/utils/security/include/report.inc, Line 40
function GetPkgName( script_name )
783: pop param 'script_name'
var i;
784: decl local #1
785: #
for( i:=1; i<=len(script_name); i+=1 )
786: local #1
787: 1L
788: :=
789: #
790: local #1
791: local #0
792: Func(0,4): Len
793: <=
794: if false goto 814
if( !Check_ValidChar( script_name[i] ))
795: local #0
796: local #1
797: [] 1
798: 0L
799: makelocal
800: jmp userfunc @1029
801: if true goto 806
script_name[i] := " ";
802: local #0
803: local #1
804: " "
805: [] := (1) #
SleepMS(5);
806: 5L
807: Func(3,2): Sleepms
808: #
809: local #1
810: 1L
811: +=
812: #
813: goto790
foreach poss_pkg in ( SplitWords( script_name ))
814: local #0
815: " "
816: Func(0,6): SplitWords
817: initforeach @826
if( GetPackageByName( poss_pkg ))
818: local #2
819: Func(4,0): GetPackageByName
820: if false goto 823
return poss_pkg;
821: local #2
822: return
SleepMS(5);
823: 5L
824: Func(3,2): Sleepms
825: #
826: stepforeach @818
827: leave block(3)
return 0;
828: 0L
829: return
c:/ZH099/pkg/utils/gumps/include/gumps_ex.inc, Line 104
function GFTextCoords(type:=ALIGN_CENTER, gump_text, x_pos, width:=0)
830: pop param 'width'
831: pop param 'x_pos'
832: pop param 'gump_text'
833: pop param 'type'
x_pos := CInt(x_pos);
834: local #1
835: Func(0,2): CInt
836: local1 := 
width := CInt(width);
837: local #0
838: Func(0,2): CInt
839: local0 := 
if ( type == ALIGN_CENTER )
840: local #3
841: 1L
842: ==
843: if false goto 857
return CInt(x_pos+CInt((width-GFTextWidth(gump_text))/2));
844: local #1
845: local #0
846: local #2
847: makelocal
848: jmp userfunc @919
849: -
850: 2L
851: /
852: Func(0,2): CInt
853: +
854: Func(0,2): CInt
855: return
856: goto868
elseif ( type == ALIGN_RIGHT )
857: local #3
858: 2L
859: ==
860: if false goto 868
return CInt(x_pos-GFTextWidth(gump_text));
861: local #1
862: local #2
863: makelocal
864: jmp userfunc @919
865: -
866: Func(0,2): CInt
867: return
868: 0L
869: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 263
function GFTextLine(byref gump, x, y, hue:=0, text:="")
870: pop param 'text'
871: pop param 'hue'
872: pop param 'y'
873: pop param 'x'
874: pop param byref 'gump'
gump.data.Append(""+CStr(text));
875: local #4
876: get member 'data'
877: ""
878: local #0
879: Func(0,3): CStr
880: +
881: Call Method id append (#52, 1 params)
882: #
var index := gump.data.Size()-1;
883: decl local #5
884: local #4
885: get member 'data'
886: Call Method id size (#48, 0 params)
887: 1L
888: -
889: :=
890: #
(gump.layout).Append("Text "+CStr(CInt(x))+" "+CStr(CInt(y))+" "
891: local #4
892: get member 'layout'
893: "Text "
894: local #3
895: Func(0,2): CInt
896: Func(0,3): CStr
897: +
898: " "
899: +
900: local #2
901: Func(0,2): CInt
902: Func(0,3): CStr
903: +
904: " "
905: +
906: local #1
907: Func(0,2): CInt
908: Func(0,3): CStr
909: +
910: " "
911: +
912: local #5
913: Func(0,3): CStr
914: +
915: Call Method id append (#52, 1 params)
916: #
return (index);
917: local #5
918: return
c:/ZH099/pkg/utils/gumps/include/gumps_ex.inc, Line 124
function GFTextWidth(gump_text)
919: pop param 'gump_text'
var gft_length := struct;
920: decl local #1
921: struct
922: :=
923: #
gft_length.+charsf :=
924: local #1
925: "charsf"
926: .+
927: "||||||||||||||`',.;:::::::::!!!!!!!!!!!!!!il1[]]]]]]]]]"bcejot”(){}===adfpqrszI„~~~~ghnuvy<>-----xJ578$?++++++ kCE2369^/*****mwABDFOPŽ™40%%GLNQSZ@#######HRT&__________KšUYYYYYYYYYYYXXXXXXXXXXXXXXVVVVVVVVVVVVVVMMMMMMMMMMMMMMWWWWWWWWWWWWWW"
928: := #
gft_length.+width := array
929: local #1
930: "width"
931: .+
932: array
933: 2L
934: init{}
935: 3L
936: init{}
937: 4L
938: init{}
939: 5L
940: init{}
941: 6L
942: init{}
943: 7L
944: init{}
945: 8L
946: init{}
947: 9L
948: init{}
949: 10L
950: init{}
951: 11L
952: init{}
953: 12L
954: init{}
955: 13L
956: init{}
957: 14L
958: init{}
959: 15L
960: init{}
961: 16L
962: init{}
963: 18L
964: init{}
965: 21L
966: init{}
967: := #
var points:=0;
968: decl local #2
969: 0L
970: :=
971: #
var j := Len(gump_text);
972: decl local #3
973: local #0
974: Func(0,4): Len
975: :=
976: #
for ( j; j>0; j-=1 )
977: local #3
978: #
979: local #3
980: 0L
981: >
982: if false goto 1027
var i := Find(gft_length.charsf, gump_text[j], 1) - 1;
983: decl local #0
984: local #1
985: get member 'charsf'
986: local #0
987: local #3
988: [] 1
989: 1L
990: Func(0,5): Find
991: 1L
992: -
993: :=
994: #
if ( i>=0 )
995: local #4
996: 0L
997: >=
998: if false goto 1012
points += gft_length.width[CInt(i/14)+1];
999: local #2
1000: local #1
1001: get member 'width'
1002: local #4
1003: 14L
1004: /
1005: Func(0,2): CInt
1006: 1L
1007: +
1008: [] 1
1009: +=
1010: #
1011: goto1021
print("XGFTextWidth: Unknown Character = '"+gump_text[j]+"'");
1012: "XGFTextWidth: Unknown Character = '"
1013: local #0
1014: local #3
1015: [] 1
1016: +
1017: "'"
1018: +
1019: Func(1,0): Print
1020: #
1021: leave block(1)
1022: local #3
1023: 1L
1024: -=
1025: #
1026: goto979
return (points);
1027: local #2
1028: return
c:/ZH099/scripts/include/string.inc, Line 147
function Check_ValidChar( text, allow_space:=0 )
1029: pop param 'allow_space'
1030: pop param 'text'
var valid_char := array{ "a", "b", "c", "d", "e", "f", "g",
1031: decl local #2
1032: array
1033: "a"
1034: init{}
1035: "b"
1036: init{}
1037: "c"
1038: init{}
1039: "d"
1040: init{}
1041: "e"
1042: init{}
1043: "f"
1044: init{}
1045: "g"
1046: init{}
1047: "h"
1048: init{}
1049: "i"
1050: init{}
1051: "j"
1052: init{}
1053: "k"
1054: init{}
1055: "l"
1056: init{}
1057: "m"
1058: init{}
1059: "n"
1060: init{}
1061: "o"
1062: init{}
1063: "p"
1064: init{}
1065: "q"
1066: init{}
1067: "r"
1068: init{}
1069: "s"
1070: init{}
1071: "t"
1072: init{}
1073: "u"
1074: init{}
1075: "v"
1076: init{}
1077: "w"
1078: init{}
1079: "x"
1080: init{}
1081: "y"
1082: init{}
1083: "z"
1084: init{}
1085: "A"
1086: init{}
1087: "B"
1088: init{}
1089: "C"
1090: init{}
1091: "D"
1092: init{}
1093: "E"
1094: init{}
1095: "F"
1096: init{}
1097: "G"
1098: init{}
1099: "H"
1100: init{}
1101: "I"
1102: init{}
1103: "P"
1104: init{}
1105: "O"
1106: init{}
1107: "N"
1108: init{}
1109: "M"
1110: init{}
1111: "L"
1112: init{}
1113: "K"
1114: init{}
1115: "J"
1116: init{}
1117: "Q"
1118: init{}
1119: "R"
1120: init{}
1121: "S"
1122: init{}
1123: "T"
1124: init{}
1125: "U"
1126: init{}
1127: "V"
1128: init{}
1129: "W"
1130: init{}
1131: "X"
1132: init{}
1133: "Y"
1134: init{}
1135: "Z"
1136: init{}
1137: "1"
1138: init{}
1139: "2"
1140: init{}
1141: "3"
1142: init{}
1143: "4"
1144: init{}
1145: "5"
1146: init{}
1147: "6"
1148: init{}
1149: "7"
1150: init{}
1151: "8"
1152: init{}
1153: "9"
1154: init{}
1155: "0"
1156: init{}
1157: :=
1158: #
var len_text := Len( text );
1159: decl local #3
1160: local #1
1161: Func(0,4): Len
1162: :=
1163: #
var i;
1164: decl local #4
1165: #
for( i:=1; i<=len_text; i+=1 )
1166: local #4
1167: 1L
1168: :=
1169: #
1170: local #4
1171: local #3
1172: <=
1173: if false goto 1216
SleepMS(5);
1174: 5L
1175: Func(3,2): Sleepms
1176: #
var letter := CStr( text[i] );
1177: decl local #0
1178: local #1
1179: local #4
1180: [] 1
1181: Func(0,3): CStr
1182: :=
1183: #
if( letter in valid_char )
1184: local #5
1185: local #2
1186: in
1187: if false goto 1191
continue;
1188: leave block(1)
1189: goto1211
1190: goto1208
elseif( allow_space && ( text[i] == " " || CAsc( text[i] ) == 0 ))
1191: local #0
1192: local #1
1193: local #4
1194: [] 1
1195: " "
1196: ==
1197: local #1
1198: local #4
1199: [] 1
1200: Func(0,8): CAsc
1201: 0L
1202: ==
1203: ||
1204: &&
1205: if false goto 1208
continue;
1206: leave block(1)
1207: goto1211
return 0;
1208: 0L
1209: return
1210: leave block(1)
1211: local #4
1212: 1L
1213: +=
1214: #
1215: goto1170
return 1;
1216: 1L
1217: return
