C:\ZH099\pkg\systems\brainAI\scripts\itemGiven\shrine.src, Line 15
program BrainNerve( params )
include "include/string";
0: get arg 'params'
var npc		:= params[1];
1: decl local #1
2: local #0
3: 1L
4: [] 1
5: :=
6: #
var event	:= params[3];
7: decl local #2
8: local #0
9: 3L
10: [] 1
11: :=
12: #
params := 0; // Not needed anymore.
13: 0L
14: local0 := 
while( npc )
15: local #1
16: if false goto 39
if( event )
17: local #2
18: if false goto 32
case( event.type )
19: local #2
20: get member 'type'
21: casejmp
	1024: @22
	default: @29
ItemGivenEvent( npc, event );
22: local #1
23: local #2
24: makelocal
25: jmp userfunc @43
26: #
break;
27: goto28
28: goto30
break;
29: goto30
event := 0;
30: 0L
31: local2 := 
SleepMS(5);
32: 5L
33: Func(3,2): Sleepms
34: #
event := Wait_For_Event(1);
35: 1L
36: Func(3,6): Wait_For_Event
37: local2 := 
38: goto15
return 1;
39: 1L
40: progend
41: leave block(3)
42: progend
C:\ZH099\pkg\systems\brainAI\scripts\itemGiven\shrine.src, Line 44
function ItemGivenEvent( npc, byref event )
43: pop param byref 'event'
44: pop param 'npc'
var item := event.item;
45: decl local #2
46: local #0
47: get member 'item'
48: :=
49: #
var source := event.source;
50: decl local #3
51: local #0
52: get member 'source'
53: :=
54: #
ReleaseItem( item );
55: local #2
56: Func(2,10): ReleaseItem
57: #
if( event.source.hidden || event.source.IsA( POLCLASS_NPC ))
58: local #0
59: get member 'source'
60: get member id 'hidden' (32)
61: local #0
62: get member 'source'
63: 4L
64: Call Method id isa (#0, 1 params)
65: ||
66: if false goto 69
return 1;
67: 1L
68: return
var element := GetObjProperty( item, "Enchanted" );
69: decl local #4
70: local #2
71: "Enchanted"
72: Func(2,2): GetObjProperty
73: :=
74: #
var npc_template := NPC_GetNPCConfig( npc.npctemplate );
75: decl local #5
76: local #1
77: get member id 'npctemplate' (62)
78: makelocal
79: jmp userfunc @330
80: :=
81: #
var npc_element := npc_template.Element;
82: decl local #6
83: local #5
84: get member 'Element'
85: :=
86: #
if( !element || !npc_element || npc_element != element )
87: local #4
88: !
89: local #6
90: !
91: ||
92: local #6
93: local #4
94: <>
95: ||
96: if false goto 119
AI_Speak( npc, "I have nowhere to put "+item.desc+", but thank you anyway.", SP
97: local #1
98: "I have nowhere to put "
99: local #2
100: get member id 'desc' (19)
101: +
102: ", but thank you anyway."
103: +
104: "default"
105: 1L
106: 0L
107: makelocal
108: jmp userfunc @738
109: #
MoveItemToContainer( item, source.backpack );
110: local #2
111: local #3
112: get member id 'backpack' (41)
113: -1L
114: -1L
115: Func(2,11): MoveItemToContainer
116: #
return 0;
117: 0L
118: return
var prop_elem := GetObjProperty( source, element+"pentagram" );
119: decl local #7
120: local #3
121: local #4
122: "pentagram"
123: +
124: Func(2,2): GetObjProperty
125: :=
126: #
if( !prop_elem )
127: local #7
128: if true goto 149
prop_elem := array{0,0,0,0,0,0,0,0,0};
129: array
130: 0L
131: init{}
132: 0L
133: init{}
134: 0L
135: init{}
136: 0L
137: init{}
138: 0L
139: init{}
140: 0L
141: init{}
142: 0L
143: init{}
144: 0L
145: init{}
146: 0L
147: init{}
148: local7 := 
var found_value := 0;
149: decl local #8
150: 0L
151: :=
152: #
case( item.objtype )
153: local #2
154: get member id 'objtype' (4)
155: casejmp
	30087: @156
	30088: @168
	30089: @180
	30090: @192
	30091: @204
	30092: @216
	30093: @228
	30094: @240
	30095: @252
	default: @263
if( !prop_elem[1] )
156: local #7
157: 1L
158: [] 1
159: if true goto 166
prop_elem[1] := 1;
160: local #7
161: 1L
162: 1L
163: [] := (1) #
found_value := 1;
164: 1L
165: local8 := 
break;
166: goto167
167: goto263
if( !prop_elem[2] )
168: local #7
169: 2L
170: [] 1
171: if true goto 178
prop_elem[2] := 1;
172: local #7
173: 2L
174: 1L
175: [] := (1) #
found_value := 2;
176: 2L
177: local8 := 
break;
178: goto179
179: goto263
if( !prop_elem[3] )
180: local #7
181: 3L
182: [] 1
183: if true goto 190
prop_elem[3] := 1;
184: local #7
185: 3L
186: 1L
187: [] := (1) #
found_value := 3;
188: 3L
189: local8 := 
break;
190: goto191
191: goto263
if( !prop_elem[4] )
192: local #7
193: 4L
194: [] 1
195: if true goto 202
prop_elem[4] := 1;
196: local #7
197: 4L
198: 1L
199: [] := (1) #
found_value := 4;
200: 4L
201: local8 := 
break;
202: goto203
203: goto263
if( !prop_elem[5] )
204: local #7
205: 5L
206: [] 1
207: if true goto 214
prop_elem[5] := 1;
208: local #7
209: 5L
210: 1L
211: [] := (1) #
found_value := 5;
212: 5L
213: local8 := 
break;
214: goto215
215: goto263
if( !prop_elem[6] )
216: local #7
217: 6L
218: [] 1
219: if true goto 226
prop_elem[6] := 1;
220: local #7
221: 6L
222: 1L
223: [] := (1) #
found_value := 6;
224: 6L
225: local8 := 
break;
226: goto227
227: goto263
if( !prop_elem[7] )
228: local #7
229: 7L
230: [] 1
231: if true goto 238
prop_elem[7] := 1;
232: local #7
233: 7L
234: 1L
235: [] := (1) #
found_value := 7;
236: 7L
237: local8 := 
break;
238: goto239
239: goto263
if( !prop_elem[8] )
240: local #7
241: 8L
242: [] 1
243: if true goto 250
prop_elem[8] := 1;
244: local #7
245: 8L
246: 1L
247: [] := (1) #
found_value := 8;
248: 8L
249: local8 := 
break;
250: goto251
251: goto263
if( !prop_elem[9] )
252: local #7
253: 9L
254: [] 1
255: if true goto 262
prop_elem[9] := 1;
256: local #7
257: 9L
258: 1L
259: [] := (1) #
found_value := 9;
260: 9L
261: local8 := 
break;
262: goto263
if( !found_value )
263: local #8
264: if true goto 280
SendSysMessage( source, "You have already given that piece!" );
265: local #3
266: "You have already given that piece!"
267: 3L
268: 1000L
269: Func(2,6): SendSysMessage
270: #
MoveItemToContainer( item, source.backpack );
271: local #2
272: local #3
273: get member id 'backpack' (41)
274: -1L
275: -1L
276: Func(2,11): MoveItemToContainer
277: #
return 0;
278: 0L
279: return
DestroyItem( item );
280: local #2
281: Func(2,12): DestroyItem
282: #
SetObjProperty( source, element+"pentagram", prop_elem );
283: local #3
284: local #4
285: "pentagram"
286: +
287: local #7
288: Func(2,1): SetObjProperty
289: #
AI_Speak( npc, "You have found "+element+" Pentagram piece "+found_value+"!", S
290: local #1
291: "You have found "
292: local #4
293: +
294: " Pentagram piece "
295: +
296: local #8
297: +
298: "!"
299: +
300: "default"
301: 1L
302: 0L
303: makelocal
304: jmp userfunc @738
305: #
Sleep(1);
306: 1L
307: Func(3,7): Sleep
308: #
if( CheckForAll( prop_elem ))
309: local #7
310: makelocal
311: jmp userfunc @782
312: if false goto 328
var SendPrize := Send_ElementalPrize( source, element );
313: decl local #0
314: local #3
315: local #4
316: makelocal
317: jmp userfunc @449
318: :=
319: #
if( SendPrize )
320: local #9
321: if false goto 327
ClearElements( source, element );
322: local #3
323: local #4
324: makelocal
325: jmp userfunc @806
326: #
327: leave block(1)
return 1;
328: 1L
329: return
c:/ZH099/pkg/systems/brainAI/include/npcUtil.inc, Line 35
function NPC_GetNPCConfig( template )
330: pop param 'template'
if( !template.package )
331: local #0
332: get member 'package'
333: if true goto 338
template := NPC_ParseTemplateName( template );
334: local #0
335: makelocal
336: jmp userfunc @387
337: local0 := 
var npc_cfg := ReadConfigFile( ":"+template.package+":npcdesc" );
338: decl local #1
339: ":"
340: local #0
341: get member 'package'
342: +
343: ":npcdesc"
344: +
345: Func(5,0): ReadConfigFile
346: :=
347: #
if( npc_cfg.errortext )
348: local #1
349: get member 'errortext'
350: if false goto 363
return error{"errortext":="Error::NPC_GetNPCConfig() - Could not open :"+templa
351: error
352: "Error::NPC_GetNPCConfig() - Could not open :"
353: local #0
354: get member 'package'
355: +
356: ":npcdesc ->"
357: +
358: local #1
359: get member 'errortext'
360: +
361: addmember-assign(errortext)
362: return
var cfg_elem := npc_cfg[template.template];
363: decl local #2
364: local #1
365: local #0
366: get member 'template'
367: [] 1
368: :=
369: #
if( cfg_elem.errortext )
370: local #2
371: get member 'errortext'
372: if false goto 385
return error{"errortext":="Error::NPC_GetNPCConfig() - Could not find elem ["+t
373: error
374: "Error::NPC_GetNPCConfig() - Could not find elem ["
375: local #0
376: get member 'template'
377: +
378: "] ->"
379: +
380: local #2
381: get member 'errortext'
382: +
383: addmember-assign(errortext)
384: return
return cfg_elem;
385: local #2
386: return
c:/ZH099/pkg/systems/brainAI/include/npcUtil.inc, Line 11
function NPC_ParseTemplateName( template_name )
387: pop param 'template_name'
if( template_name.IsA( POLCLASS_NPC ))
388: local #0
389: 4L
390: Call Method id isa (#0, 1 params)
391: if false goto 395
template_name := template_name.npctemplate;
392: local #0
393: get member id 'npctemplate' (62)
394: local0 := 
var colon_a := Find( template_name, ":", 1 );
395: decl local #1
396: local #0
397: ":"
398: 1L
399: Func(0,3): Find
400: :=
401: #
var colon_b := Find( template_name, ":", 2 );
402: decl local #2
403: local #0
404: ":"
405: 2L
406: Func(0,3): Find
407: :=
408: #
var parsed := struct{"package", "template"};
409: decl local #3
410: struct
411: addmember(package)
412: addmember(template)
413: :=
414: #
if( !colon_a || !colon_b )
415: local #1
416: !
417: local #2
418: !
419: ||
420: if false goto 428
parsed.package := "";
421: local #3
422: ""
423: set member 'package' #
parsed.template := template_name;
424: local #3
425: local #0
426: set member 'template' #
427: goto447
parsed.package := template_name[colon_a+1, colon_b-2];
428: local #3
429: local #0
430: local #1
431: 1L
432: +
433: local #2
434: 2L
435: -
436: [,]
437: set member 'package' #
parsed.template := template_name[colon_b+1, Len( template_name )];
438: local #3
439: local #0
440: local #2
441: 1L
442: +
443: local #0
444: Func(0,4): Len
445: [,]
446: set member 'template' #
return parsed;
447: local #3
448: return
c:/ZH099/pkg/items/elementals/include/elementals.inc, Line 27
function Send_ElementalPrize( mobile, elemental )
449: pop param 'elemental'
450: pop param 'mobile'
elemental := UCFirst( elemental );
451: local #0
452: makelocal
453: jmp userfunc @717
454: local0 := 
var settings := ELE_GetSettingsCfgElem( elemental );
455: decl local #2
456: local #0
457: 0L
458: makelocal
459: jmp userfunc @1212
460: :=
461: #
if( settings.errortext )
462: local #2
463: get member 'errortext'
464: if false goto 476
SendSysMessage( mobile, "Error:: Unable to find element [:elementals:settings.c
465: local #1
466: "Error:: Unable to find element [:elementals:settings.cfg] ->"
467: local #2
468: get member 'errortext'
469: +
470: 3L
471: 1000L
472: Func(2,6): SendSysMessage
473: #
return 0;
474: 0L
475: return
var text := "";
476: decl local #3
477: ""
478: :=
479: #
var gump := GFCreateGump();
480: decl local #4
481: 0L
482: 0L
483: 0L
484: 0L
485: makelocal
486: jmp userfunc @1397
487: :=
488: #
GFClosable( gump, 0 );
489: local #4
490: 0L
491: makelocal
492: jmp userfunc @1338
493: #
GFResizePic( gump, 0, 0, GFGetCfgConst( "Defaults", "BackGround" ), 500, 390 );
494: local #4
495: 0L
496: 0L
497: "Defaults"
498: "BackGround"
499: makelocal
500: jmp userfunc @1504
501: 500L
502: 390L
503: makelocal
504: jmp userfunc @1566
505: #
GFResizePic( gump, 15, 45, GFGetCfgConst( "Defaults", "ForeGround" ), 470, 335 
506: local #4
507: 15L
508: 45L
509: "Defaults"
510: "ForeGround"
511: makelocal
512: jmp userfunc @1504
513: 470L
514: 335L
515: makelocal
516: jmp userfunc @1566
517: #
GFResizePic( gump, 15, 15, GFGetCfgConst( "Defaults", "ForeGround" ), 470, 25 )
518: local #4
519: 15L
520: 15L
521: "Defaults"
522: "ForeGround"
523: makelocal
524: jmp userfunc @1504
525: 470L
526: 25L
527: makelocal
528: jmp userfunc @1566
529: #
GFTextMid( gump, 15, 17, 470, 1720, "The "+elemental+" Prize Screen" );
530: local #4
531: 15L
532: 17L
533: 470L
534: 1720L
535: "The "
536: local #0
537: +
538: " Prize Screen"
539: +
540: makelocal
541: jmp userfunc @1710
542: #
GFTilePic( gump, 70, 80, settings.Weapon, settings.Color );
543: local #4
544: 70L
545: 80L
546: local #2
547: get member id 'weapon' (42)
548: local #2
549: get member id 'color' (7)
550: makelocal
551: jmp userfunc @1735
552: #
GFTilePic( gump, 70, 180, 0x13d3, settings.Color );
553: local #4
554: 70L
555: 180L
556: 5075L
557: local #2
558: get member id 'color' (7)
559: makelocal
560: jmp userfunc @1735
561: #
GFTilePic( gump, 70, 280, 0x1416, settings.Color );
562: local #4
563: 70L
564: 280L
565: 5142L
566: local #2
567: get member id 'color' (7)
568: makelocal
569: jmp userfunc @1735
570: #
text := settings.WeaponDesc;
571: local #2
572: get member 'WeaponDesc'
573: local3 := 
GFDrawWrappedText( gump, 160, 80, GFWordWrap( text, 300 ) );
574: local #4
575: 160L
576: 80L
577: local #3
578: 300L
579: makelocal
580: jmp userfunc @1784
581: 2100L
582: makelocal
583: jmp userfunc @1478
584: #
text := settings.LeatherDesc;
585: local #2
586: get member 'LeatherDesc'
587: local3 := 
GFDrawWrappedText( gump, 160, 180, GFWordWrap( text, 300 ) );
588: local #4
589: 160L
590: 180L
591: local #3
592: 300L
593: makelocal
594: jmp userfunc @1784
595: 2100L
596: makelocal
597: jmp userfunc @1478
598: #
text := settings.PlatemailDesc;
599: local #2
600: get member 'PlatemailDesc'
601: local3 := 
GFDrawWrappedText( gump, 160, 280, GFWordWrap( text, 300 ) );
602: local #4
603: 160L
604: 280L
605: local #3
606: 300L
607: makelocal
608: jmp userfunc @1784
609: 2100L
610: makelocal
611: jmp userfunc @1478
612: #
GFAddButton( gump, 40, 105, 2117, 2118, GF_CLOSE_BTN, 1 );
613: local #4
614: 40L
615: 105L
616: 2117L
617: 2118L
618: 1L
619: 1L
620: makelocal
621: jmp userfunc @1256
622: #
GFAddButton( gump, 40, 205, 2117, 2118, GF_CLOSE_BTN, 2 );
623: local #4
624: 40L
625: 205L
626: 2117L
627: 2118L
628: 1L
629: 2L
630: makelocal
631: jmp userfunc @1256
632: #
GFAddButton( gump, 40, 305, 2117, 2118, GF_CLOSE_BTN, 3 );
633: local #4
634: 40L
635: 305L
636: 2117L
637: 2118L
638: 1L
639: 3L
640: makelocal
641: jmp userfunc @1256
642: #
var input := GFSendGump( mobile, gump );
643: decl local #5
644: local #1
645: local #4
646: makelocal
647: jmp userfunc @1623
648: :=
649: #
if( input[1] )
650: local #5
651: 1L
652: [] 1
653: if false goto 671
Create_ElementalWeapon( mobile, elemental );
654: local #1
655: local #0
656: makelocal
657: jmp userfunc @1161
658: #
ReportText( mobile.serial+" created Elemental Weapon: "+elemental, REPORT_SYSLO
659: local #1
660: get member id 'serial' (6)
661: " created Elemental Weapon: "
662: +
663: local #0
664: +
665: 2L
666: 0L
667: makelocal
668: jmp userfunc @1910
669: #
670: goto715
elseif( input[2] )
671: local #5
672: 2L
673: [] 1
674: if false goto 692
Create_ElementalLeather( mobile, elemental );
675: local #1
676: local #0
677: makelocal
678: jmp userfunc @996
679: #
ReportText( mobile.serial+" created Elemental LeatherArmor: "+elemental, REPORT
680: local #1
681: get member id 'serial' (6)
682: " created Elemental LeatherArmor: "
683: +
684: local #0
685: +
686: 2L
687: 0L
688: makelocal
689: jmp userfunc @1910
690: #
691: goto715
elseif( input[3] )
692: local #5
693: 3L
694: [] 1
695: if false goto 713
Create_ElementalArmor( mobile, elemental );
696: local #1
697: local #0
698: makelocal
699: jmp userfunc @831
700: #
ReportText( mobile.serial+" created Elemental PlateArmor: "+elemental, REPORT_S
701: local #1
702: get member id 'serial' (6)
703: " created Elemental PlateArmor: "
704: +
705: local #0
706: +
707: 2L
708: 0L
709: makelocal
710: jmp userfunc @1910
711: #
712: goto715
return 0;
713: 0L
714: return
return 1;
715: 1L
716: return
c:/ZH099/scripts/include/string.inc, Line 46
function UCFirst( text )
717: pop param 'text'
text := CStr(text);
718: local #0
719: Func(0,5): CStr
720: local0 := 
if ( Len(text) > 1 )
721: local #0
722: Func(0,4): Len
723: 1L
724: >
725: if false goto 736
text := Lower(text);
726: local #0
727: Func(0,0): Lower
728: local0 := 
text[1] := Upper(text[1]);
729: local #0
730: 1L
731: local #0
732: 1L
733: [] 1
734: Func(0,7): Upper
735: [] := (1) #
return text;
736: local #0
737: return
c:/ZH099/pkg/systems/brainAI/include/npcCommands.inc, Line 139
function AI_Speak( npc, text, text_type:=SPEAK_TEXTTYPE_DEFAULT, do_event:=SPEA
738: pop param 'no_wake'
739: pop param 'do_event'
740: pop param 'text_type'
741: pop param 'text'
742: pop param 'npc'
var ev		:= struct;
743: decl local #5
744: struct
745: :=
746: #
ev.+type	:= NPCEVENT_SPEAK;
747: local #5
748: "type"
749: .+
750: 10485765L
751: := #
ev.+text	:= text;
752: local #5
753: "text"
754: .+
755: local #3
756: := #
ev.+texttype	:= text_type;
757: local #5
758: "texttype"
759: .+
760: local #2
761: := #
ev.+doevent	:= do_event;
762: local #5
763: "doevent"
764: .+
765: local #1
766: := #
ev.+WakeUp	:= no_wake;
767: local #5
768: "WakeUp"
769: .+
770: local #0
771: := #
ev.+process	:= GetProcess( GetPid() );
772: local #5
773: "process"
774: .+
775: Func(3,4): GetPid
776: Func(3,1): GetProcess
777: := #
return SendEvent( npc, ev );
778: local #4
779: local #5
780: Func(2,3): SendEvent
781: return
C:\ZH099\pkg\systems\brainAI\scripts\itemGiven\shrine.src, Line 151
function CheckForAll( prop_elem )
782: pop param 'prop_elem'
var i;
783: decl local #1
784: #
for( i:=1; i<=9; i+=1 )
785: local #1
786: 1L
787: :=
788: #
789: local #1
790: 9L
791: <=
792: if false goto 804
if( !prop_elem[i] );
793: local #0
794: local #1
795: [] 1
796: if true goto 799
return 0;
797: 0L
798: return
799: local #1
800: 1L
801: +=
802: #
803: goto789
return 1;
804: 1L
805: return
C:\ZH099\pkg\systems\brainAI\scripts\itemGiven\shrine.src, Line 163
function ClearElements( source, element )
806: pop param 'element'
807: pop param 'source'
var i;
808: decl local #2
809: #
for( i:=1; i<=9; i+=1 )
810: local #2
811: 1L
812: :=
813: #
814: local #2
815: 9L
816: <=
817: if false goto 829
EraseObjProperty( source, element+"pentagram" );
818: local #1
819: local #0
820: "pentagram"
821: +
822: Func(2,13): EraseObjProperty
823: #
824: local #2
825: 1L
826: +=
827: #
828: goto814
return 1;
829: 1L
830: return
c:/ZH099/pkg/items/elementals/include/elementals.inc, Line 154
function Create_ElementalArmor( mobile, elemental )
831: pop param 'elemental'
832: pop param 'mobile'
var settings := ELE_GetSettingsCfgElem( elemental );
833: decl local #2
834: local #0
835: 0L
836: makelocal
837: jmp userfunc @1212
838: :=
839: #
if( settings.errortext )
840: local #2
841: get member 'errortext'
842: if false goto 854
SendSysMessage( mobile, "Error:: Unable to find element [:elementals:settings.c
843: local #1
844: "Error:: Unable to find element [:elementals:settings.cfg] ->"
845: local #2
846: get member 'errortext'
847: +
848: 3L
849: 1000L
850: Func(2,6): SendSysMessage
851: #
return 0;
852: 0L
853: return
var create_EParmor;
854: decl local #3
855: #
create_EParmor := CreateItemInBackpack( mobile, 0x759c, 1 );
856: local #1
857: 30108L
858: 1L
859: Func(2,9): CreateItemInBackpack
860: local3 := 
create_EParmor.color := settings.Color;
861: local #3
862: local #2
863: get member id 'color' (7)
864: set member id 'color' (7) #
create_EParmor.name := "Platemail Breastplate of the "+elemental+" Element";
865: local #3
866: "Platemail Breastplate of the "
867: local #0
868: +
869: " Element"
870: +
871: set member id 'name' (3) #
SetObjProperty( create_EParmor, Elemental+"Protection", 3 );
872: local #3
873: local #0
874: "Protection"
875: +
876: 3L
877: Func(2,1): SetObjProperty
878: #
create_EParmor := CreateItemInBackpack( mobile, 0x1f0c, 1 );
879: local #1
880: 7948L
881: 1L
882: Func(2,9): CreateItemInBackpack
883: local3 := 
create_EParmor.color := settings.Color;
884: local #3
885: local #2
886: get member id 'color' (7)
887: set member id 'color' (7) #
create_EParmor.name := "Platemail Arms of the "+elemental+" Element";
888: local #3
889: "Platemail Arms of the "
890: local #0
891: +
892: " Element"
893: +
894: set member id 'name' (3) #
SetObjProperty( create_EParmor, Elemental+"Protection", 3 );
895: local #3
896: local #0
897: "Protection"
898: +
899: 3L
900: Func(2,1): SetObjProperty
901: #
create_EParmor := CreateItemInBackpack( mobile, 0x1f0d, 1 );
902: local #1
903: 7949L
904: 1L
905: Func(2,9): CreateItemInBackpack
906: local3 := 
create_EParmor.color := settings.Color;
907: local #3
908: local #2
909: get member id 'color' (7)
910: set member id 'color' (7) #
create_EParmor.name := "Platemail Leggings of the "+elemental+" Element";
911: local #3
912: "Platemail Leggings of the "
913: local #0
914: +
915: " Element"
916: +
917: set member id 'name' (3) #
SetObjProperty( create_EParmor, Elemental+"Protection", 3 );
918: local #3
919: local #0
920: "Protection"
921: +
922: 3L
923: Func(2,1): SetObjProperty
924: #
create_EParmor := CreateItemInBackpack( mobile, 0x1f0e, 1 );
925: local #1
926: 7950L
927: 1L
928: Func(2,9): CreateItemInBackpack
929: local3 := 
create_EParmor.color := settings.Color;
930: local #3
931: local #2
932: get member id 'color' (7)
933: set member id 'color' (7) #
create_EParmor.name := "Platemail Gloves of the "+elemental+" Element";
934: local #3
935: "Platemail Gloves of the "
936: local #0
937: +
938: " Element"
939: +
940: set member id 'name' (3) #
SetObjProperty( create_EParmor, Elemental+"Protection", 3 );
941: local #3
942: local #0
943: "Protection"
944: +
945: 3L
946: Func(2,1): SetObjProperty
947: #
create_EParmor := CreateItemInBackpack( mobile, 0x1f0f, 1 );
948: local #1
949: 7951L
950: 1L
951: Func(2,9): CreateItemInBackpack
952: local3 := 
create_EParmor.color := settings.Color;
953: local #3
954: local #2
955: get member id 'color' (7)
956: set member id 'color' (7) #
create_EParmor.name := "Platemail Gorget of the "+elemental+" Element";
957: local #3
958: "Platemail Gorget of the "
959: local #0
960: +
961: " Element"
962: +
963: set member id 'name' (3) #
SetObjProperty( create_EParmor, Elemental+"Protection", 3 );
964: local #3
965: local #0
966: "Protection"
967: +
968: 3L
969: Func(2,1): SetObjProperty
970: #
create_EParmor := CreateItemInBackpack( mobile, 0x1f10, 1 );
971: local #1
972: 7952L
973: 1L
974: Func(2,9): CreateItemInBackpack
975: local3 := 
create_EParmor.color := settings.Color;
976: local #3
977: local #2
978: get member id 'color' (7)
979: set member id 'color' (7) #
create_EParmor.name := "Closed Helm of the "+elemental+" Element";
980: local #3
981: "Closed Helm of the "
982: local #0
983: +
984: " Element"
985: +
986: set member id 'name' (3) #
SetObjProperty( create_EParmor, Elemental+"Protection", 3 );
987: local #3
988: local #0
989: "Protection"
990: +
991: 3L
992: Func(2,1): SetObjProperty
993: #
return 1;
994: 1L
995: return
c:/ZH099/pkg/items/elementals/include/elementals.inc, Line 105
function Create_ElementalLeather( mobile, elemental )
996: pop param 'elemental'
997: pop param 'mobile'
var settings := ELE_GetSettingsCfgElem( elemental );
998: decl local #2
999: local #0
1000: 0L
1001: makelocal
1002: jmp userfunc @1212
1003: :=
1004: #
if( settings.errortext )
1005: local #2
1006: get member 'errortext'
1007: if false goto 1019
SendSysMessage( mobile, "Error:: Unable to find element [:elementals:settings.c
1008: local #1
1009: "Error:: Unable to find element [:elementals:settings.cfg] ->"
1010: local #2
1011: get member 'errortext'
1012: +
1013: 3L
1014: 1000L
1015: Func(2,6): SendSysMessage
1016: #
return 0;
1017: 0L
1018: return
var create_ELarmor;
1019: decl local #3
1020: #
create_ELarmor := CreateItemInBackpack( mobile, 0x7596, 1 );
1021: local #1
1022: 30102L
1023: 1L
1024: Func(2,9): CreateItemInBackpack
1025: local3 := 
create_ELarmor.color := settings.Color;
1026: local #3
1027: local #2
1028: get member id 'color' (7)
1029: set member id 'color' (7) #
create_ELarmor.name := "Leather Gorget of the "+elemental+" Element";
1030: local #3
1031: "Leather Gorget of the "
1032: local #0
1033: +
1034: " Element"
1035: +
1036: set member id 'name' (3) #
SetObjProperty( create_ELarmor, elemental+"Protection", 3 );
1037: local #3
1038: local #0
1039: "Protection"
1040: +
1041: 3L
1042: Func(2,1): SetObjProperty
1043: #
create_ELarmor := CreateItemInBackpack( mobile, 0x7597, 1 );
1044: local #1
1045: 30103L
1046: 1L
1047: Func(2,9): CreateItemInBackpack
1048: local3 := 
create_ELarmor.color := settings.Color;
1049: local #3
1050: local #2
1051: get member id 'color' (7)
1052: set member id 'color' (7) #
create_ELarmor.name := "Leather Sleeves of the "+elemental+" Element";
1053: local #3
1054: "Leather Sleeves of the "
1055: local #0
1056: +
1057: " Element"
1058: +
1059: set member id 'name' (3) #
SetObjProperty( create_ELarmor, elemental+"Protection", 3 );
1060: local #3
1061: local #0
1062: "Protection"
1063: +
1064: 3L
1065: Func(2,1): SetObjProperty
1066: #
create_ELarmor := CreateItemInBackpack( mobile, 0x7598, 1 );
1067: local #1
1068: 30104L
1069: 1L
1070: Func(2,9): CreateItemInBackpack
1071: local3 := 
create_ELarmor.color := settings.Color;
1072: local #3
1073: local #2
1074: get member id 'color' (7)
1075: set member id 'color' (7) #
create_ELarmor.name := "Leather Gloves of the "+elemental+" Element";
1076: local #3
1077: "Leather Gloves of the "
1078: local #0
1079: +
1080: " Element"
1081: +
1082: set member id 'name' (3) #
SetObjProperty( create_ELarmor, elemental+"Protection", 3 );
1083: local #3
1084: local #0
1085: "Protection"
1086: +
1087: 3L
1088: Func(2,1): SetObjProperty
1089: #
create_ELarmor := CreateItemInBackpack( mobile, 0x7599, 1 );
1090: local #1
1091: 30105L
1092: 1L
1093: Func(2,9): CreateItemInBackpack
1094: local3 := 
create_ELarmor.color := settings.Color;
1095: local #3
1096: local #2
1097: get member id 'color' (7)
1098: set member id 'color' (7) #
create_ELarmor.name := "Leather Cap of the "+elemental+" Element";
1099: local #3
1100: "Leather Cap of the "
1101: local #0
1102: +
1103: " Element"
1104: +
1105: set member id 'name' (3) #
SetObjProperty( create_ELarmor, elemental+"Protection", 3 );
1106: local #3
1107: local #0
1108: "Protection"
1109: +
1110: 3L
1111: Func(2,1): SetObjProperty
1112: #
create_ELarmor := CreateItemInBackpack( mobile, 0x759a, 1 );
1113: local #1
1114: 30106L
1115: 1L
1116: Func(2,9): CreateItemInBackpack
1117: local3 := 
create_ELarmor.color := settings.Color;
1118: local #3
1119: local #2
1120: get member id 'color' (7)
1121: set member id 'color' (7) #
create_ELarmor.name := "Leather Leggings of the "+elemental+" Element";
1122: local #3
1123: "Leather Leggings of the "
1124: local #0
1125: +
1126: " Element"
1127: +
1128: set member id 'name' (3) #
SetObjProperty( create_ELarmor, elemental+"Protection", 3 );
1129: local #3
1130: local #0
1131: "Protection"
1132: +
1133: 3L
1134: Func(2,1): SetObjProperty
1135: #
create_ELarmor := CreateItemInBackpack( mobile, 0x759b, 1 );
1136: local #1
1137: 30107L
1138: 1L
1139: Func(2,9): CreateItemInBackpack
1140: local3 := 
create_ELarmor.color := settings.Color;
1141: local #3
1142: local #2
1143: get member id 'color' (7)
1144: set member id 'color' (7) #
create_ELarmor.name := "Leather Tunic of the "+elemental+" Element";
1145: local #3
1146: "Leather Tunic of the "
1147: local #0
1148: +
1149: " Element"
1150: +
1151: set member id 'name' (3) #
SetObjProperty( create_ELarmor, elemental+"Protection", 3 );
1152: local #3
1153: local #0
1154: "Protection"
1155: +
1156: 3L
1157: Func(2,1): SetObjProperty
1158: #
return 1;
1159: 1L
1160: return
c:/ZH099/pkg/items/elementals/include/elementals.inc, Line 86
function Create_ElementalWeapon( mobile, elemental )
1161: pop param 'elemental'
1162: pop param 'mobile'
var settings := ELE_GetSettingsCfgElem( elemental );
1163: decl local #2
1164: local #0
1165: 0L
1166: makelocal
1167: jmp userfunc @1212
1168: :=
1169: #
if( settings.errortext )
1170: local #2
1171: get member 'errortext'
1172: if false goto 1184
SendSysMessage( mobile, "Error:: Unable to find element [:elementals:settings.c
1173: local #1
1174: "Error:: Unable to find element [:elementals:settings.cfg] ->"
1175: local #2
1176: get member 'errortext'
1177: +
1178: 3L
1179: 1000L
1180: Func(2,6): SendSysMessage
1181: #
return 0;
1182: 0L
1183: return
var Weapon_Name := settings.WeaponName;
1184: decl local #3
1185: local #2
1186: get member 'WeaponName'
1187: :=
1188: #
var create_Eweapon := CreateItemInBackpack( mobile, Weapon_Name, 1 );
1189: decl local #4
1190: local #1
1191: local #3
1192: 1L
1193: Func(2,9): CreateItemInBackpack
1194: :=
1195: #
if( create_Eweapon.errortext )
1196: local #4
1197: get member 'errortext'
1198: if false goto 1210
SendSysMessage( mobile, "Error:: Unable to create element [:elementals:settings
1199: local #1
1200: "Error:: Unable to create element [:elementals:settings.cfg] ->"
1201: local #4
1202: get member 'errortext'
1203: +
1204: 3L
1205: 1000L
1206: Func(2,6): SendSysMessage
1207: #
return 0;
1208: 0L
1209: return
return 1;
1210: 1L
1211: return
c:/ZH099/pkg/items/elementals/include/settings.inc, Line 48
function ELE_GetSettingsCfgElem(elem_name, byref cfg_file:=0)
1212: pop param byref 'cfg_file'
1213: pop param 'elem_name'
if ( !cfg_file )
1214: local #0
1215: if true goto 1219
cfg_file := ELE_GetSettingsCfgFile();
1216: makelocal
1217: jmp userfunc @1240
1218: local0 := 
var elem := cfg_file[elem_name];
1219: decl local #2
1220: local #0
1221: local #1
1222: [] 1
1223: :=
1224: #
if ( elem.errortext )
1225: local #2
1226: get member 'errortext'
1227: if false goto 1238
SysLog("Error::ELE_GetSettingsCfgElem() - Unable to find elem ["+elem_name+"] -
1228: "Error::ELE_GetSettingsCfgElem() - Unable to find elem ["
1229: local #1
1230: +
1231: "] ->"
1232: +
1233: local #2
1234: get member 'errortext'
1235: +
1236: Func(3,0): SysLog
1237: #
return elem;
1238: local #2
1239: return
c:/ZH099/pkg/items/elementals/include/settings.inc, Line 25
function ELE_GetSettingsCfgFile()
var cfg := ReadConfigFile(":elementals:settings");
1240: decl local #0
1241: ":elementals:settings"
1242: Func(5,0): ReadConfigFile
1243: :=
1244: #
if ( cfg.errortext )
1245: local #0
1246: get member 'errortext'
1247: if false goto 1254
SysLog("Error::ELE_GetSettingsCfgFile() - Unable to open [:elementals:settings.
1248: "Error::ELE_GetSettingsCfgFile() - Unable to open [:elementals:settings.cfg] ->"
1249: local #0
1250: get member 'errortext'
1251: +
1252: Func(3,0): SysLog
1253: #
return cfg;
1254: local #0
1255: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 172
function GFAddButton(byref gump, x, y, off_id, on_id, btn_type:=GF_PAGE_BTN, bt
1256: pop param 'btn_value'
1257: pop param 'btn_type'
1258: pop param 'on_id'
1259: pop param 'off_id'
1260: pop param 'y'
1261: pop param 'x'
1262: pop param byref 'gump'
var line := "Button "+CStr(x)+" "+CStr(y)+" "+CStr(off_id)+" "+CStr(on_id);
1263: decl local #7
1264: "Button "
1265: local #5
1266: Func(0,5): CStr
1267: +
1268: " "
1269: +
1270: local #4
1271: Func(0,5): CStr
1272: +
1273: " "
1274: +
1275: local #3
1276: Func(0,5): CStr
1277: +
1278: " "
1279: +
1280: local #2
1281: Func(0,5): CStr
1282: +
1283: :=
1284: #
btn_value := CInt(btn_value);
1285: local #0
1286: Func(0,2): CInt
1287: local0 := 
if ( btn_value < 1 ) // Catch errors (0) and invalid (negative) values
1288: local #0
1289: 1L
1290: <
1291: if false goto 1300
gump.data_id += 1;
1292: local #6
1293: get member 'data_id'
1294: 1L
1295: +=
1296: #
btn_value := gump.data_id;
1297: local #6
1298: get member 'data_id'
1299: local0 := 
if ( btn_type == GF_CLOSE_BTN )
1300: local #1
1301: 1L
1302: ==
1303: if false goto 1312
line += " 1 0 "+CStr(btn_value);
1304: local #7
1305: " 1 0 "
1306: local #0
1307: Func(0,5): CStr
1308: +
1309: +=
1310: #
1311: goto1331
elseif ( btn_type == GF_DUMMY_BTN )
1312: local #1
1313: 2L
1314: ==
1315: if false goto 1324
line += " 0 0 "+CStr(btn_value);
1316: local #7
1317: " 0 0 "
1318: local #0
1319: Func(0,5): CStr
1320: +
1321: +=
1322: #
1323: goto1331
line += " 0 "+CStr(btn_value);
1324: local #7
1325: " 0 "
1326: local #0
1327: Func(0,5): CStr
1328: +
1329: +=
1330: #
(gump.layout).Append(line);
1331: local #6
1332: get member 'layout'
1333: local #7
1334: Call Method id append (#52, 1 params)
1335: #
return (btn_value);
1336: local #0
1337: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 71
function GFClosable(byref gump, bool)
1338: pop param 'bool'
1339: pop param byref 'gump'
case ( bool )
1340: local #0
1341: casejmp
	0: @1342
	1: @1364
	default: @1386
if ( gump.base.CloseLoc )
1342: local #1
1343: get member 'base'
1344: get member 'CloseLoc'
1345: if false goto 1351
return XGFError("Gump already contains the 'NoClose' flag.");
1346: "Gump already contains the 'NoClose' flag."
1347: 0L
1348: makelocal
1349: jmp userfunc @1975
1350: return
(gump.layout).Append("NoClose");
1351: local #1
1352: get member 'layout'
1353: "NoClose"
1354: Call Method id append (#52, 1 params)
1355: #
gump.base.CloseLoc := (gump.layout).Size();
1356: local #1
1357: get member 'base'
1358: local #1
1359: get member 'layout'
1360: Call Method id size (#48, 0 params)
1361: set member 'CloseLoc' #
break;
1362: goto1363
1363: goto1395
if ( !gump.base.CloseLoc )
1364: local #1
1365: get member 'base'
1366: get member 'CloseLoc'
1367: if true goto 1373
return XGFError("Gump is already closable.");
1368: "Gump is already closable."
1369: 0L
1370: makelocal
1371: jmp userfunc @1975
1372: return
(gump.layout).Erase(gump.base.CloseLoc);
1373: local #1
1374: get member 'layout'
1375: local #1
1376: get member 'base'
1377: get member 'CloseLoc'
1378: Call Method id erase (#49, 1 params)
1379: #
gump.base.CloseLoc := 0;
1380: local #1
1381: get member 'base'
1382: 0L
1383: set member 'CloseLoc' #
break;
1384: goto1385
1385: goto1395
return XGFError("gumps::Closable: Invalid bool value '"+bool+"'");
1386: "gumps::Closable: Invalid bool value '"
1387: local #0
1388: +
1389: "'"
1390: +
1391: 0L
1392: makelocal
1393: jmp userfunc @1975
1394: return
return 1;
1395: 1L
1396: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 40
function GFCreateGump(x:=0, y:=0, width:=0, height:=0)
1397: pop param 'height'
1398: pop param 'width'
1399: pop param 'y'
1400: pop param 'x'
var gump := struct;
1401: decl local #4
1402: struct
1403: :=
1404: #
gump.+base := struct;
1405: local #4
1406: "base"
1407: .+
1408: struct
1409: := #
gump.base.+x := CInt(x);
1410: local #4
1411: get member 'base'
1412: "x"
1413: .+
1414: local #3
1415: Func(0,2): CInt
1416: := #
gump.base.+y := CInt(y);
1417: local #4
1418: get member 'base'
1419: "y"
1420: .+
1421: local #2
1422: Func(0,2): CInt
1423: := #
gump.base.+width := CInt(width);
1424: local #4
1425: get member 'base'
1426: "width"
1427: .+
1428: local #1
1429: Func(0,2): CInt
1430: := #
gump.base.+height := CInt(height);
1431: local #4
1432: get member 'base'
1433: "height"
1434: .+
1435: local #0
1436: Func(0,2): CInt
1437: := #
gump.base.+MoveLoc := 0;	// Movable flag location
1438: local #4
1439: get member 'base'
1440: "MoveLoc"
1441: .+
1442: 0L
1443: := #
gump.base.+CloseLoc := 0;	// NoClose flag location
1444: local #4
1445: get member 'base'
1446: "CloseLoc"
1447: .+
1448: 0L
1449: := #
gump.base.+DisposeLoc := 0;	// NoDispose flag location
1450: local #4
1451: get member 'base'
1452: "DisposeLoc"
1453: .+
1454: 0L
1455: := #
gump.+layout	:= array;	// Main layout array for entire gump
1456: local #4
1457: "layout"
1458: .+
1459: array
1460: := #
gump.+data	:= array;	// Storage array for static-text and
1461: local #4
1462: "data"
1463: .+
1464: array
1465: := #
gump.+data_id	:= 1;
1466: local #4
1467: "data_id"
1468: .+
1469: 1L
1470: := #
gump.+cur_page := 0;
1471: local #4
1472: "cur_page"
1473: .+
1474: 0L
1475: := #
return(gump);
1476: local #4
1477: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 325
function GFDrawWrappedText( byref gump, byref x, byref y, byref text_lines, txt
1478: pop param 'txt_color'
1479: pop param byref 'text_lines'
1480: pop param byref 'y'
1481: pop param byref 'x'
1482: pop param byref 'gump'
foreach line in ( text_lines )
1483: local #1
1484: initforeach @1500
GFTextLine( gump, x, y, txt_color, line );
1485: local #4
1486: local #3
1487: local #2
1488: local #0
1489: local #5
1490: makelocal
1491: jmp userfunc @1661
1492: #
y += 20;
1493: local #2
1494: 20L
1495: +=
1496: #
SleepMS(2);
1497: 2L
1498: Func(3,2): Sleepms
1499: #
1500: stepforeach @1485
1501: leave block(3)
return 1;
1502: 1L
1503: return
c:/ZH099/pkg/utils/gumps/include/gumps_ex.inc, Line 37
function GFGetCfgConst(elem_name, prop_name)
1504: pop param 'prop_name'
1505: pop param 'elem_name'
var cfg := ReadConfigFile(":gumps:GumpInfo");
1506: decl local #2
1507: ":gumps:GumpInfo"
1508: Func(5,0): ReadConfigFile
1509: :=
1510: #
if ( cfg.errortext )
1511: local #2
1512: get member 'errortext'
1513: if false goto 1522
return XGFError("GFGetCfgConst():: Unable to open GumpInfo.cfg -> "+cfg.errorte
1514: "GFGetCfgConst():: Unable to open GumpInfo.cfg -> "
1515: local #2
1516: get member 'errortext'
1517: +
1518: 0L
1519: makelocal
1520: jmp userfunc @1975
1521: return
var elem := cfg[elem_name];
1522: decl local #3
1523: local #2
1524: local #1
1525: [] 1
1526: :=
1527: #
if ( elem.errortext )
1528: local #3
1529: get member 'errortext'
1530: if false goto 1543
return XGFError("GFGetCfgConst():: Unable to find GumpInfo.cfg["+elem_name+"] -
1531: "GFGetCfgConst():: Unable to find GumpInfo.cfg["
1532: local #1
1533: +
1534: "] ->"
1535: +
1536: local #3
1537: get member 'errortext'
1538: +
1539: 0L
1540: makelocal
1541: jmp userfunc @1975
1542: return
var value := GetConfigInt(elem, prop_name);
1543: decl local #4
1544: local #3
1545: local #0
1546: Func(5,2): GetConfigInt
1547: :=
1548: #
if ( !value )
1549: local #4
1550: if true goto 1564
return XGFError("GFGetCfgConst():: Unable to find property ["+prop_name+"] in e
1551: "GFGetCfgConst():: Unable to find property ["
1552: local #0
1553: +
1554: "] in elem ["
1555: +
1556: local #1
1557: +
1558: "]"
1559: +
1560: 0L
1561: makelocal
1562: jmp userfunc @1975
1563: return
return value;
1564: local #4
1565: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 151
function GFResizePic(byref gump, x, y, gump_id, width, height)
1566: pop param 'height'
1567: pop param 'width'
1568: pop param 'gump_id'
1569: pop param 'y'
1570: pop param 'x'
1571: pop param byref 'gump'
width := CInt(width);
1572: local #1
1573: Func(0,2): CInt
1574: local1 := 
height := CInt(height);
1575: local #0
1576: Func(0,2): CInt
1577: local0 := 
if ( !width )
1578: local #1
1579: if true goto 1584
width := gump.base.width;
1580: local #5
1581: get member 'base'
1582: get member 'width'
1583: local1 := 
if ( !height )
1584: local #0
1585: if true goto 1590
height := gump.base.width;
1586: local #5
1587: get member 'base'
1588: get member 'width'
1589: local0 := 
(gump.layout).Append("ResizePic "+CStr(CInt(x))+" "+CStr(CInt(y))+" "
1590: local #5
1591: get member 'layout'
1592: "ResizePic "
1593: local #4
1594: Func(0,2): CInt
1595: Func(0,5): CStr
1596: +
1597: " "
1598: +
1599: local #3
1600: Func(0,2): CInt
1601: Func(0,5): CStr
1602: +
1603: " "
1604: +
1605: local #2
1606: Func(0,2): CInt
1607: Func(0,5): CStr
1608: +
1609: " "
1610: +
1611: local #1
1612: Func(0,5): CStr
1613: +
1614: " "
1615: +
1616: local #0
1617: Func(0,5): CStr
1618: +
1619: Call Method id append (#52, 1 params)
1620: #
return 1;
1621: 1L
1622: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 314
function GFSendGump(mobile, byref gump)
1623: pop param byref 'gump'
1624: pop param 'mobile'
var ret_val := SendDialogGump(mobile, gump.layout, gump.data, gump.base.x, gump
1625: decl local #2
1626: local #1
1627: local #0
1628: get member 'layout'
1629: local #0
1630: get member 'data'
1631: local #0
1632: get member 'base'
1633: get member id 'x' (0)
1634: local #0
1635: get member 'base'
1636: get member id 'y' (1)
1637: 0L
1638: Func(2,5): SendDialogGump
1639: :=
1640: #
if ( ret_val.errortext )
1641: local #2
1642: get member 'errortext'
1643: if false goto 1659
SendSysMessage(mobile, "Error - Unable to display gump.");
1644: local #1
1645: "Error - Unable to display gump."
1646: 3L
1647: 1000L
1648: Func(2,6): SendSysMessage
1649: #
SendSysMessage(mobile, "Error text is ->"+ret_val.errortext);
1650: local #1
1651: "Error text is ->"
1652: local #2
1653: get member 'errortext'
1654: +
1655: 3L
1656: 1000L
1657: Func(2,6): SendSysMessage
1658: #
return ret_val;
1659: local #2
1660: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 263
function GFTextLine(byref gump, x, y, hue:=0, text:="")
1661: pop param 'text'
1662: pop param 'hue'
1663: pop param 'y'
1664: pop param 'x'
1665: pop param byref 'gump'
gump.data.Append(""+CStr(text));
1666: local #4
1667: get member 'data'
1668: ""
1669: local #0
1670: Func(0,5): CStr
1671: +
1672: Call Method id append (#52, 1 params)
1673: #
var index := gump.data.Size()-1;
1674: decl local #5
1675: local #4
1676: get member 'data'
1677: Call Method id size (#48, 0 params)
1678: 1L
1679: -
1680: :=
1681: #
(gump.layout).Append("Text "+CStr(CInt(x))+" "+CStr(CInt(y))+" "
1682: local #4
1683: get member 'layout'
1684: "Text "
1685: local #3
1686: Func(0,2): CInt
1687: Func(0,5): CStr
1688: +
1689: " "
1690: +
1691: local #2
1692: Func(0,2): CInt
1693: Func(0,5): CStr
1694: +
1695: " "
1696: +
1697: local #1
1698: Func(0,2): CInt
1699: Func(0,5): CStr
1700: +
1701: " "
1702: +
1703: local #5
1704: Func(0,5): CStr
1705: +
1706: Call Method id append (#52, 1 params)
1707: #
return (index);
1708: local #5
1709: return
c:/ZH099/pkg/utils/gumps/include/gumps_ex.inc, Line 114
function GFTextMid(byref gump, x, y, width, color, text)
1710: pop param 'text'
1711: pop param 'color'
1712: pop param 'width'
1713: pop param 'y'
1714: pop param 'x'
1715: pop param byref 'gump'
var x_pos := GFTextCoords(ALIGN_CENTER, text, x, CStr(width));
1716: decl local #6
1717: 1L
1718: local #0
1719: local #4
1720: local #2
1721: Func(0,5): CStr
1722: makelocal
1723: jmp userfunc @2035
1724: :=
1725: #
return GFTextLine(gump, x_pos, y, color, CStr(text));
1726: local #5
1727: local #6
1728: local #3
1729: local #1
1730: local #0
1731: Func(0,5): CStr
1732: makelocal
1733: jmp userfunc @1661
1734: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 249
function GFTilePic(byref gump, x, y, tile_id, hue := 0)
1735: pop param 'hue'
1736: pop param 'tile_id'
1737: pop param 'y'
1738: pop param 'x'
1739: pop param byref 'gump'
var text := CStr(CInt(x))+" "+CStr(CInt(y))+" "+CStr(CInt(tile_id));
1740: decl local #5
1741: local #3
1742: Func(0,2): CInt
1743: Func(0,5): CStr
1744: " "
1745: +
1746: local #2
1747: Func(0,2): CInt
1748: Func(0,5): CStr
1749: +
1750: " "
1751: +
1752: local #1
1753: Func(0,2): CInt
1754: Func(0,5): CStr
1755: +
1756: :=
1757: #
hue := CInt(hue);
1758: local #0
1759: Func(0,2): CInt
1760: local0 := 
if ( hue )
1761: local #0
1762: if false goto 1773
text := "TilePicHue "+text+" "+CStr(hue);
1763: "TilePicHue "
1764: local #5
1765: +
1766: " "
1767: +
1768: local #0
1769: Func(0,5): CStr
1770: +
1771: local5 := 
1772: goto1777
text := "TilePic "+text;
1773: "TilePic "
1774: local #5
1775: +
1776: local5 := 
(gump.layout).Append(text);
1777: local #4
1778: get member 'layout'
1779: local #5
1780: Call Method id append (#52, 1 params)
1781: #
return 1;
1782: 1L
1783: return
c:/ZH099/pkg/utils/gumps/include/gumps_ex.inc, Line 165
function GFWordWrap(text, pixels)
1784: pop param 'pixels'
1785: pop param 'text'
var wrap_lines := array{};
1786: decl local #2
1787: array
1788: :=
1789: #
var word_list := SplitWords(text);
1790: decl local #3
1791: local #1
1792: " "
1793: Func(0,6): SplitWords
1794: :=
1795: #
var space_size := GFTextWidth(" ");
1796: decl local #4
1797: " "
1798: makelocal
1799: jmp userfunc @2075
1800: :=
1801: #
var cur_line := "";
1802: decl local #5
1803: ""
1804: :=
1805: #
var cur_length := 0;
1806: decl local #6
1807: 0L
1808: :=
1809: #
var start_new := 0;
1810: decl local #7
1811: 0L
1812: :=
1813: #
foreach word in ( word_list )
1814: local #3
1815: initforeach @1883
var word_width := GFTextWidth(word);
1816: decl local #0
1817: local #8
1818: makelocal
1819: jmp userfunc @2075
1820: :=
1821: #
if ( word == "[P]" )
1822: local #8
1823: "[P]"
1824: ==
1825: if false goto 1833
word := "";
1826: ""
1827: local8 := 
word_width := 0;
1828: 0L
1829: local11 := 
start_new := 1;
1830: 1L
1831: local7 := 
1832: goto1853
elseif ( (word_width+cur_length) > pixels )
1833: local #11
1834: local #6
1835: +
1836: local #0
1837: >
1838: if false goto 1853
start_new := 1;
1839: 1L
1840: local7 := 
if ( cur_line[Len(cur_line)] == " " )
1841: local #5
1842: local #5
1843: Func(0,4): Len
1844: [] 1
1845: " "
1846: ==
1847: if false goto 1853
cur_line[Len(cur_line)] := "";
1848: local #5
1849: local #5
1850: Func(0,4): Len
1851: ""
1852: [] := (1) #
if ( start_new )
1853: local #7
1854: if false goto 1865
start_new := 0;
1855: 0L
1856: local7 := 
wrap_lines.Append(cur_line);
1857: local #2
1858: local #5
1859: Call Method id append (#52, 1 params)
1860: #
cur_line := "";
1861: ""
1862: local5 := 
cur_length := 0;
1863: 0L
1864: local6 := 
if ( word )
1865: local #8
1866: if false goto 1879
cur_line += word+" ";
1867: local #5
1868: local #8
1869: " "
1870: +
1871: +=
1872: #
cur_length += word_width+space_size;
1873: local #6
1874: local #11
1875: local #4
1876: +
1877: +=
1878: #
SleepMS(2);
1879: 2L
1880: Func(3,2): Sleepms
1881: #
1882: leave block(1)
1883: stepforeach @1816
1884: leave block(3)
if ( wrap_lines[wrap_lines.Size()] != cur_line )
1885: local #2
1886: local #2
1887: Call Method id size (#48, 0 params)
1888: [] 1
1889: local #5
1890: <>
1891: if false goto 1908
if ( cur_line[Len(cur_line)] == " " )
1892: local #5
1893: local #5
1894: Func(0,4): Len
1895: [] 1
1896: " "
1897: ==
1898: if false goto 1904
cur_line[Len(cur_line)] := "";
1899: local #5
1900: local #5
1901: Func(0,4): Len
1902: ""
1903: [] := (1) #
wrap_lines.Append(cur_line);
1904: local #2
1905: local #5
1906: Call Method id append (#52, 1 params)
1907: #
return wrap_lines;
1908: local #2
1909: return
c:/ZH099/pkg/utils/security/include/report.inc, Line 22
function ReportText( report_text:="?", flags:=REPORT_DISABLE, text_color:=0 )
1910: pop param 'text_color'
1911: pop param 'flags'
1912: pop param 'report_text'
if( !flags )
1913: local #1
1914: if true goto 1918
return 0;
1915: 0L
1916: return
1917: goto1973
elseif( flags & REPORT_CONSOLE )
1918: local #1
1919: 1L
1920: &
1921: if false goto 1928
Print( ""+report_text );
1922: ""
1923: local #2
1924: +
1925: Func(1,0): Print
1926: #
1927: goto1973
elseif( flags & REPORT_SYSLOG )
1928: local #1
1929: 2L
1930: &
1931: if false goto 1962
var script_name := CStr( GetProcess( GetPid() ).name ),
1932: decl local #0
1933: Func(3,4): GetPid
1934: Func(3,1): GetProcess
1935: get member id 'name' (3)
1936: Func(0,5): CStr
1937: :=
1938: #
1939: decl local #1
1940: local #3
1941: makelocal
1942: jmp userfunc @1988
1943: :=
1944: #
LogToFile( "::log/"+pkg_name+".log", "["+script_name+"]: "+report_text, LOG_DAT
1945: "::log/"
1946: local #4
1947: +
1948: ".log"
1949: +
1950: "["
1951: local #3
1952: +
1953: "]: "
1954: +
1955: local #2
1956: +
1957: 1L
1958: Func(6,0): LogToFile
1959: #
1960: leave block(2)
1961: goto1973
elseif( flags & REPORT_BROADCAST )
1962: local #1
1963: 4L
1964: &
1965: if false goto 1973
Broadcast( ""+report_text, 3, text_color );
1966: ""
1967: local #2
1968: +
1969: 3L
1970: local #0
1971: Func(2,8): Broadcast
1972: #
return 1;
1973: 1L
1974: return
c:/ZH099/pkg/utils/gumps/include/gumps.inc, Line 335
function XGFError(text, log:=0)
1975: pop param 'log'
1976: pop param 'text'
if ( log )
1977: local #0
1978: if false goto 1984
SysLog("Gump Error:: "+text);
1979: "Gump Error:: "
1980: local #1
1981: +
1982: Func(3,0): SysLog
1983: #
return error{"errortext":=text};
1984: error
1985: local #1
1986: addmember-assign(errortext)
1987: return
c:/ZH099/pkg/utils/security/include/report.inc, Line 40
function GetPkgName( script_name )
1988: pop param 'script_name'
var i;
1989: decl local #1
1990: #
for( i:=1; i<=len(script_name); i+=1 )
1991: local #1
1992: 1L
1993: :=
1994: #
1995: local #1
1996: local #0
1997: Func(0,4): Len
1998: <=
1999: if false goto 2019
if( !Check_ValidChar( script_name[i] ))
2000: local #0
2001: local #1
2002: [] 1
2003: 0L
2004: makelocal
2005: jmp userfunc @2185
2006: if true goto 2011
script_name[i] := " ";
2007: local #0
2008: local #1
2009: " "
2010: [] := (1) #
SleepMS(5);
2011: 5L
2012: Func(3,2): Sleepms
2013: #
2014: local #1
2015: 1L
2016: +=
2017: #
2018: goto1995
foreach poss_pkg in ( SplitWords( script_name ))
2019: local #0
2020: " "
2021: Func(0,6): SplitWords
2022: initforeach @2031
if( GetPackageByName( poss_pkg ))
2023: local #2
2024: Func(4,1): GetPackageByName
2025: if false goto 2028
return poss_pkg;
2026: local #2
2027: return
SleepMS(5);
2028: 5L
2029: Func(3,2): Sleepms
2030: #
2031: stepforeach @2023
2032: leave block(3)
return 0;
2033: 0L
2034: return
c:/ZH099/pkg/utils/gumps/include/gumps_ex.inc, Line 104
function GFTextCoords(type:=ALIGN_CENTER, gump_text, x_pos, width:=0)
2035: pop param 'width'
2036: pop param 'x_pos'
2037: pop param 'gump_text'
2038: pop param 'type'
x_pos := CInt(x_pos);
2039: local #1
2040: Func(0,2): CInt
2041: local1 := 
width := CInt(width);
2042: local #0
2043: Func(0,2): CInt
2044: local0 := 
if ( type == ALIGN_CENTER )
2045: local #3
2046: 1L
2047: ==
2048: if false goto 2062
return CInt(x_pos+CInt((width-GFTextWidth(gump_text))/2));
2049: local #1
2050: local #0
2051: local #2
2052: makelocal
2053: jmp userfunc @2075
2054: -
2055: 2L
2056: /
2057: Func(0,2): CInt
2058: +
2059: Func(0,2): CInt
2060: return
2061: goto2073
elseif ( type == ALIGN_RIGHT )
2062: local #3
2063: 2L
2064: ==
2065: if false goto 2073
return CInt(x_pos-GFTextWidth(gump_text));
2066: local #1
2067: local #2
2068: makelocal
2069: jmp userfunc @2075
2070: -
2071: Func(0,2): CInt
2072: return
2073: 0L
2074: return
c:/ZH099/pkg/utils/gumps/include/gumps_ex.inc, Line 124
function GFTextWidth(gump_text)
2075: pop param 'gump_text'
var gft_length := struct;
2076: decl local #1
2077: struct
2078: :=
2079: #
gft_length.+charsf :=
2080: local #1
2081: "charsf"
2082: .+
2083: "||||||||||||||`',.;:::::::::!!!!!!!!!!!!!!il1[]]]]]]]]]"bcejot(){}===adfpqrszI~~~~ghnuvy<>-----xJ578$?++++++ kCE2369^/*****mwABDFOP40%%GLNQSZ@#######HRT&__________KUYYYYYYYYYYYXXXXXXXXXXXXXXVVVVVVVVVVVVVVMMMMMMMMMMMMMMWWWWWWWWWWWWWW"
2084: := #
gft_length.+width := array
2085: local #1
2086: "width"
2087: .+
2088: array
2089: 2L
2090: init{}
2091: 3L
2092: init{}
2093: 4L
2094: init{}
2095: 5L
2096: init{}
2097: 6L
2098: init{}
2099: 7L
2100: init{}
2101: 8L
2102: init{}
2103: 9L
2104: init{}
2105: 10L
2106: init{}
2107: 11L
2108: init{}
2109: 12L
2110: init{}
2111: 13L
2112: init{}
2113: 14L
2114: init{}
2115: 15L
2116: init{}
2117: 16L
2118: init{}
2119: 18L
2120: init{}
2121: 21L
2122: init{}
2123: := #
var points:=0;
2124: decl local #2
2125: 0L
2126: :=
2127: #
var j := Len(gump_text);
2128: decl local #3
2129: local #0
2130: Func(0,4): Len
2131: :=
2132: #
for ( j; j>0; j-=1 )
2133: local #3
2134: #
2135: local #3
2136: 0L
2137: >
2138: if false goto 2183
var i := Find(gft_length.charsf, gump_text[j], 1) - 1;
2139: decl local #0
2140: local #1
2141: get member 'charsf'
2142: local #0
2143: local #3
2144: [] 1
2145: 1L
2146: Func(0,3): Find
2147: 1L
2148: -
2149: :=
2150: #
if ( i>=0 )
2151: local #4
2152: 0L
2153: >=
2154: if false goto 2168
points += gft_length.width[CInt(i/14)+1];
2155: local #2
2156: local #1
2157: get member 'width'
2158: local #4
2159: 14L
2160: /
2161: Func(0,2): CInt
2162: 1L
2163: +
2164: [] 1
2165: +=
2166: #
2167: goto2177
print("XGFTextWidth: Unknown Character = '"+gump_text[j]+"'");
2168: "XGFTextWidth: Unknown Character = '"
2169: local #0
2170: local #3
2171: [] 1
2172: +
2173: "'"
2174: +
2175: Func(1,0): Print
2176: #
2177: leave block(1)
2178: local #3
2179: 1L
2180: -=
2181: #
2182: goto2135
return (points);
2183: local #2
2184: return
c:/ZH099/scripts/include/string.inc, Line 147
function Check_ValidChar( text, allow_space:=0 )
2185: pop param 'allow_space'
2186: pop param 'text'
var valid_char := array{ "a", "b", "c", "d", "e", "f", "g",
2187: decl local #2
2188: array
2189: "a"
2190: init{}
2191: "b"
2192: init{}
2193: "c"
2194: init{}
2195: "d"
2196: init{}
2197: "e"
2198: init{}
2199: "f"
2200: init{}
2201: "g"
2202: init{}
2203: "h"
2204: init{}
2205: "i"
2206: init{}
2207: "j"
2208: init{}
2209: "k"
2210: init{}
2211: "l"
2212: init{}
2213: "m"
2214: init{}
2215: "n"
2216: init{}
2217: "o"
2218: init{}
2219: "p"
2220: init{}
2221: "q"
2222: init{}
2223: "r"
2224: init{}
2225: "s"
2226: init{}
2227: "t"
2228: init{}
2229: "u"
2230: init{}
2231: "v"
2232: init{}
2233: "w"
2234: init{}
2235: "x"
2236: init{}
2237: "y"
2238: init{}
2239: "z"
2240: init{}
2241: "A"
2242: init{}
2243: "B"
2244: init{}
2245: "C"
2246: init{}
2247: "D"
2248: init{}
2249: "E"
2250: init{}
2251: "F"
2252: init{}
2253: "G"
2254: init{}
2255: "H"
2256: init{}
2257: "I"
2258: init{}
2259: "P"
2260: init{}
2261: "O"
2262: init{}
2263: "N"
2264: init{}
2265: "M"
2266: init{}
2267: "L"
2268: init{}
2269: "K"
2270: init{}
2271: "J"
2272: init{}
2273: "Q"
2274: init{}
2275: "R"
2276: init{}
2277: "S"
2278: init{}
2279: "T"
2280: init{}
2281: "U"
2282: init{}
2283: "V"
2284: init{}
2285: "W"
2286: init{}
2287: "X"
2288: init{}
2289: "Y"
2290: init{}
2291: "Z"
2292: init{}
2293: "1"
2294: init{}
2295: "2"
2296: init{}
2297: "3"
2298: init{}
2299: "4"
2300: init{}
2301: "5"
2302: init{}
2303: "6"
2304: init{}
2305: "7"
2306: init{}
2307: "8"
2308: init{}
2309: "9"
2310: init{}
2311: "0"
2312: init{}
2313: :=
2314: #
var len_text := Len( text );
2315: decl local #3
2316: local #1
2317: Func(0,4): Len
2318: :=
2319: #
var i;
2320: decl local #4
2321: #
for( i:=1; i<=len_text; i+=1 )
2322: local #4
2323: 1L
2324: :=
2325: #
2326: local #4
2327: local #3
2328: <=
2329: if false goto 2372
SleepMS(5);
2330: 5L
2331: Func(3,2): Sleepms
2332: #
var letter := CStr( text[i] );
2333: decl local #0
2334: local #1
2335: local #4
2336: [] 1
2337: Func(0,5): CStr
2338: :=
2339: #
if( letter in valid_char )
2340: local #5
2341: local #2
2342: in
2343: if false goto 2347
continue;
2344: leave block(1)
2345: goto2367
2346: goto2364
elseif( allow_space && ( text[i] == " " || CAsc( text[i] ) == 0 ))
2347: local #0
2348: local #1
2349: local #4
2350: [] 1
2351: " "
2352: ==
2353: local #1
2354: local #4
2355: [] 1
2356: Func(0,8): CAsc
2357: 0L
2358: ==
2359: ||
2360: &&
2361: if false goto 2364
continue;
2362: leave block(1)
2363: goto2367
return 0;
2364: 0L
2365: return
2366: leave block(1)
2367: local #4
2368: 1L
2369: +=
2370: #
2371: goto2326
return 1;
2372: 1L
2373: return
