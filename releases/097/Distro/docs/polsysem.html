<!DOCTYPE html PUBLIC "-//W3C//XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><title>POL Scripting Reference</title>
<meta name="keyword" content="POL, EScript, documentation, Ultima Online, UO, packets, client, ultima online client, emulator">
<meta name="description" content="Penultima Online Documentation website."> <meta name="Author" content="Racalac, Rykard"> <meta name="Generator" content="POL Doc-o-matic"> <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> <meta http-equiv="Content-Style-Type" content="text/css"> <style type="text/css"><!-- body,td,p { font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 8pt; font-weight: normal; color: #000000} --></style></head>


	<body style="background-color: rgb(240, 240, 240);">
<p style="font-size: 14pt; font-weight: bold; text-align: left;">
File: POLsys.em</p><p style="font-size: 10pt; font-weight: bold; text-align: left;">
Description: Functions to access POL system data.<br> Last
Modified: 10/27/2007</p><p> File Constants: </p><pre><ul>const MSGLEN_VARIABLE := -1;<br></ul></pre><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="CreatePacket">CreatePacket(type,
size)</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Parameters:</th></tr></tbody><tbody><tr bgcolor="#d4d4d4"><td>Name</td><td>Type</td></tr></tbody><tbody><tr><td width="50%"><var>type</var></td><td>Integer</td></tr><tr><td width="50%"><var>size</var></td><td>Integer</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">Creates a new packet object. Type is the byte
command id that always is set as the first byte (no need to set it
yourself). Size is the fixed-length size for this packet, or
MSGLEN_VARIABLE if it is variable length (no need to figure out the
size in advance, the packet buffer will be resized as need by using the
Set* methods).</td></tr><tr><td colspan="2">Notes:
polsys.em constants for this function:
</td></tr><tr><td colspan="2"><pre>const MSGLEN_VARIABLE := -1;</pre></td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">A new packet object or Error</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Errors</th></tr></tbody><tbody><tr><td colspan="2">"Invalid parameter type."</td></tr><tr><td colspan="2">"Packet type too high"</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Related</th></tr></tbody><tbody><tr><td colspan="2"><a href="objref.php#Packet"><b>Packet</b></a></td></tr></tbody></table><br><br><br><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="GetCmdLevelName">GetCmdLevelName(number)</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Parameters:</th></tr></tbody><tbody><tr bgcolor="#d4d4d4"><td>Name</td><td>Type</td></tr></tbody><tbody><tr><td width="50%"><var>number</var></td><td>Integer</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">Will get a command level's name.</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">CmdLevelName or Error</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Errors</th></tr></tbody><tbody><tr><td colspan="2">"Invalid parameter type."</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Related
Configs</th></tr></tbody><tbody><tr><td colspan="2"><a href="configfiles.php#cmds.cfg"><b>cmds.cfg</b></a></td></tr></tbody></table><br><br><br><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="GetCmdLevelNumber">GetCmdLevelNumber(name)</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Parameters:</th></tr></tbody><tbody><tr bgcolor="#d4d4d4"><td>Name</td><td>Type</td></tr></tbody><tbody><tr><td width="50%"><var>name</var></td><td>String</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">Will get the numeric value of a command level.</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">CmdLevel or Error</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Errors</th></tr></tbody><tbody><tr><td colspan="2">"Invalid parameter type."</td></tr><tr><td colspan="2">"Could not find a command level with that name."</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Related
Configs</th></tr></tbody><tbody><tr><td colspan="2"><a href="configfiles.php#cmds.cfg"><b>cmds.cfg</b></a></td></tr></tbody></table><br><br><br><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="GetItemDescriptor">GetItemDescriptor(objtype)</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Parameters:</th></tr></tbody><tbody><tr bgcolor="#d4d4d4"><td>Name</td><td>Type</td></tr></tbody><tbody><tr><td width="50%"><var>objtype</var></td><td>int
Objtype OR string ObjtypeName</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">Returns a struct of all itemdesc.cfg properties
for the objtype.</td></tr><tr><td colspan="2">The
keys are the property names, i.e. "Color", "Desc", etc. The values can
be String, Integer, Real. The exceptions are "CProps" and
"StackingIgnoresCProps". "CProps" is a dictionary where the CProp name
is the key, and the value can be any packable type (i.e. array, struct,
etc.). "StackingIgnoresCProps" is an array of strings.</td></tr><tr><td colspan="2">Note: Descriptor of Weapon will return MinDamage
and MaxDamage calculated from Damage-Dice too.</td></tr><tr><td colspan="2">The primary use of this function is to pass it
to any of the item creation functions, and the values in the struct
will be used in place of the static itemdesc.cfg values. Use it to
assign specific properties to an item during creation, rather than
after. This allows easier stacking with existing item stacks.</td></tr><tr><td colspan="2">Note: Not all properties can be assigned
per-item, so editing the value in the descriptor struct will not be
passed to the new item.
</td></tr><tr><td colspan="2"><pre>//For example, to stack with an existing stack with color 0x10 and cprop<br>use uo;<br>use polsys;<br>program testdesc(who,objtype)<br> var ret := GetItemDescriptor(CInt(objtype));<br> ret.Color := 0x10;<br> ret.CProps.insert("blah","1"); //assuming the existing stack have this color and cprop<br> ret.StackingIgnoresCProps.append("blingbling"); <br> var item := CreateItemInBackpack(who,ret,10);<br> if(item)<br> print("OK!");<br> endif<br>endprogram</pre></td></tr><tr><td colspan="2"><pre>To print the contents of the struct:<br>var ret := GetItemDescriptor(objtype);<br>foreach thing in ret<br> print(_thing_iter + ": " + thing);<br>endforeach</pre></td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">A struct of all itemdesc.cfg properties and
values.</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Errors</th></tr></tbody><tbody><tr><td colspan="2">"Invalid parameter type"</td></tr><tr><td colspan="2">"Itemdesc.cfg entry for objtype X not found."</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Related
Configs</th></tr></tbody><tbody><tr><td colspan="2"><a href="configfiles.php#itemdesc.cfg"><b>itemdesc.cfg</b></a></td></tr></tbody></table><br><br><br><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="GetPackageByName">GetPackageByName(name)</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Parameters:</th></tr></tbody><tbody><tr bgcolor="#d4d4d4"><td>Name</td><td>Type</td></tr></tbody><tbody><tr><td width="50%"><var>name</var></td><td>String</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">Will return a package reference.</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">PackageRef or Error</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Errors</th></tr></tbody><tbody><tr><td colspan="2">"Invalid parameter type."</td></tr><tr><td colspan="2">"No package found by that name."</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Related</th></tr></tbody><tbody><tr><td colspan="2"><a href="objref.php#Package"><b>Package</b></a></td></tr></tbody></table><br><br><br><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="IncRevision">IncRevision(
object )</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Parameters:</th></tr></tbody><tbody><tr bgcolor="#d4d4d4"><td>Name</td><td>Type</td></tr></tbody><tbody><tr><td width="50%"><var>object</var></td><td>UObject
Ref</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">Increases the internal "Revision" number of an
UObject. Used to manually increase this number for scripted changes to
things such as mob.race and such where core does not auto increase it.</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">1 on success</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Errors</th></tr></tbody><tbody><tr><td colspan="2">"Invalid parameter type."</td></tr></tbody></table><br><br><br><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="ListenPoints">ListenPoints(
)</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">Array of listen points...</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">Array</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Errors</th></tr></tbody><tbody><tr><td colspan="2">"Invalid parameter type."</td></tr></tbody></table><br><br><br><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="ListTextCommands">ListTextCommands( )</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">Returns a dict of a dict of structs.</td></tr><tr><td colspan="2">Dict 1 - Package names Dict 2 - Command levels
Struct - .dir .script</td></tr><tr><td colspan="2">
</td></tr><tr><td colspan="2"><pre>	Example:<br>	foreach package in ( commands )<br>	Print("Pkg:"+_package_iter);<br>	foreach level in ( package )<br>	Print(" CmdLvl:"+_level_iter);<br>	foreach command in ( level )<br>	Print(" "+command);<br>	SleepMS(2);<br>	endforeach<br>	SleepMS(2);<br>	endforeach<br>	SleepMS(2);<br>	endforeach<br> </pre></td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">1 on success</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Errors</th></tr></tbody><tbody><tr><td colspan="2">"Invalid parameter type."</td></tr></tbody></table><br><br><br><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="Packages">Packages()</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">Get an array of "package objects", with "name",
"supports_http" and "npcdesc" members. (more info TBD)</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">An array of package objects.</td></tr></tbody></table><br><br><br><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="ReadMillisecondClock">ReadMillisecondClock()</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">Returns a long integer of the current
millisecond clock. TBD: timebase of clock, saved with server?</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">Current time in milliseconds.</td></tr></tbody></table><br><br><br><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="Realms">Realms(realms:="")</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">Returns a dictionary of structs.</td></tr><tr><td colspan="2">If a single case-sensitive realm name is passed,
will return the information for only that realm.</td></tr><tr><td colspan="2">example:
</td></tr><tr><td colspan="2"><pre> "realm_name" -&gt; "width"<br> "height"<br> "mapid"<br> "toplevel_item_count"<br> "mobile_count"<br> "season"</pre></td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">A dictionary of structs of Realms.</td></tr></tbody></table><br><br><br><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="ReloadConfiguration">ReloadConfiguration()</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">reloads pol.cfg (most entries) and npcdesc.cfg</td></tr><tr><td colspan="2">Linux: HUP signal will cause ReloadConfiguration
to be called.</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">1</td></tr></tbody></table><br><br><br><table align="center" bgcolor="#dddddd" border="1" cellpadding="1" cellspacing="0" frame="box" rules="groups" width="75%"><tbody><tr><th colspan="2" align="center"><a name="SetSysTrayPopupText">SetSysTrayPopupText(text)</a></th></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Parameters:</th></tr></tbody><tbody><tr bgcolor="#d4d4d4"><td>Name</td><td>Type</td></tr></tbody><tbody><tr><td width="50%"><var>text</var></td><td>String
tooltip text for systray icon</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Explanation</th></tr></tbody><tbody><tr><td colspan="2">Sets the systray icon's tooltip text (win32 only)</td></tr></tbody><tbody><tr bgcolor="#cccccc"><th colspan="2" align="left">Return
values</th></tr></tbody><tbody><tr><td colspan="2">1</td></tr></tbody></table><br><br><br>
<hr> <p style="font-size: 9pt; font-weight: bold; text-align: center;">
If you <i>know</i> if any information is incorrect on
these pages, mail your corrections to polteam@polserver.com </p>
<p style="font-size: 7pt; font-weight: bold; text-align: center;">
Copyright ©2003-2006 David Carpman and POL Development Team, all rights
reserved. DO NOT REPRODUCE, MIRROR, ALTER, SPINDLE, MUTILATE, OR SIT
ON. </p> </body></html>